import{_ as i,o as a,c as t,ah as e}from"./chunks/framework.504LQ1l3.js";const n="/assets/skills-security-hub-01.B8mNcEu6.png",l="/assets/skills-mcp-configure-01.BTrbaass.png",r="/assets/skills-security-dashboard-01.CVml3M3-.png",h="/assets/skills-submission-table-01.CrqbeurH.png",p="/assets/skills-registry-buttons-01.BK_ypTUG.png",o="/assets/skills-report-activity-01.4WT7N0z8.png",m=JSON.parse('{"title":"AI Skill Security Hub - User Guide","description":"","frontmatter":{},"headers":[],"relativePath":"features/skill-security-user-guide.md","filePath":"features/skill-security-user-guide.md"}'),k={name:"features/skill-security-user-guide.md"};function d(c,s,u,g,y,E){return a(),t("div",null,[...s[0]||(s[0]=[e('<h1 id="ai-skill-security-hub-user-guide" tabindex="-1">AI Skill Security Hub - User Guide <a class="header-anchor" href="#ai-skill-security-hub-user-guide" aria-label="Permalink to &quot;AI Skill Security Hub - User Guide&quot;">​</a></h1><h2 id="what-is-the-skill-security-hub" tabindex="-1">What Is the Skill Security Hub? <a class="header-anchor" href="#what-is-the-skill-security-hub" aria-label="Permalink to &quot;What Is the Skill Security Hub?&quot;">​</a></h2><p>Personal AI assistants like Claude Code, Cursor, Agent Zero and openClaw use <strong>skills</strong> (also called plugins or extensions) to perform tasks, reading files, browsing the web, running code, and more. Research has shown that <strong>12% of skills in public marketplaces contain malicious patterns</strong>, with nearly 3% dynamically fetching and executing remote content at runtime.</p><p>The Skill Security Hub turns your AI Security Gateway into a <strong>centralized skill approval authority</strong>. AI assistants submit their skills for automated security scanning, and you decide which skills are safe to use.</p><p><img src="'+n+`" alt="Agent Zero"></p><p><strong>The key idea</strong>: Your AI assistants become active participants in their own security. They submit skills, check approvals, and report suspicious behavior all through the Gateway.</p><h2 id="getting-started" tabindex="-1">Getting Started <a class="header-anchor" href="#getting-started" aria-label="Permalink to &quot;Getting Started&quot;">​</a></h2><h3 id="quick-start-your-first-skill-submission" tabindex="-1">Quick Start: Your First Skill Submission <a class="header-anchor" href="#quick-start-your-first-skill-submission" aria-label="Permalink to &quot;Quick Start: Your First Skill Submission&quot;">​</a></h3><h4 id="_1-configure-your-ai-assistant" tabindex="-1">1. Configure Your AI Assistant <a class="header-anchor" href="#_1-configure-your-ai-assistant" aria-label="Permalink to &quot;1. Configure Your AI Assistant&quot;">​</a></h4><p>Tell your AI assistant about the Skill Security Hub by adding it as an MCP server.</p><p><strong>For Claude Code</strong> — add to your project&#39;s <code>.mcp.json</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;mcpServers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;skill-security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080/api/v1/mcp/skill-security&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>For Cursor</strong> — add to <code>.cursor/mcp.json</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;mcpServers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;skill-security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080/api/v1/mcp/skill-security&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>For Claude Desktop</strong> — add to <code>claude_desktop_config.json</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;mcpServers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;skill-security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:8080/api/v1/mcp/skill-security&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>For Agent Zero and other Python-based MCP clients</strong> — some clients require the transport type to be explicitly specified. If the gateway is running on the host and the client is in Docker, use <code>host.docker.internal</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;mcpServers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;skill-security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Use this MCP to use the Security Skills hub&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://host.docker.internal:8080/api/v1/mcp/skill-security&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;streamable-http&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Below we configured out Agent Zero:</p><p><img src="`+l+`" alt="Agent Zero"></p><h4 id="_2-submit-a-test-skill-via-curl" tabindex="-1">2. Submit a Test Skill via curl <a class="header-anchor" href="#_2-submit-a-test-skill-via-curl" aria-label="Permalink to &quot;2. Submit a Test Skill via curl&quot;">​</a></h4><p>You can test the system immediately with curl before connecting an AI assistant:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Initialize the connection</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/mcp/skill-security</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;id&quot;: 1,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;method&quot;: &quot;initialize&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;params&quot;: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;protocolVersion&quot;: &quot;2024-11-05&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;clientInfo&quot;: {&quot;name&quot;: &quot;test-client&quot;, &quot;version&quot;: &quot;1.0.0&quot;}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Submit a skill for analysis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/mcp/skill-security</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;id&quot;: 2,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;method&quot;: &quot;tools/call&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;params&quot;: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;name&quot;: &quot;analyze_skill&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;arguments&quot;: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;skill_name&quot;: &quot;hello-world&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;skill_source&quot;: &quot;def greet(name):\\n    return f\\&quot;Hello, {name}!\\&quot;\\n&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;description&quot;: &quot;A simple greeting skill&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;author&quot;: &quot;test&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;version&quot;: &quot;1.0.0&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;agent_name&quot;: &quot;test-client&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span></span></code></pre></div><p>This submits a harmless skill. You should see:</p><ul><li><code>risk_score: 0</code></li><li><code>risk_level: &quot;None&quot;</code></li><li><code>findings: []</code></li><li><code>approval_status: &quot;pending&quot;</code></li></ul><h4 id="_3-review-in-the-web-interface" tabindex="-1">3. Review in the Web Interface <a class="header-anchor" href="#_3-review-in-the-web-interface" aria-label="Permalink to &quot;3. Review in the Web Interface&quot;">​</a></h4><p>Open theAI SEcurity Gateway UI in your browser, then navigate to <strong>Skill Security</strong> in the sidebar.</p><p>You will see 4 tabs:</p><ul><li><strong>Dashboard</strong> — Overview statistics</li><li><strong>Submissions</strong> — All skill submissions from AI assistants</li><li><strong>Registry</strong> — The skill approval registry</li><li><strong>Activity Reports</strong> — Runtime behavior reports from AI assistants</li></ul><p>Your test skill will appear in both <strong>Submissions</strong> and <strong>Registry</strong> (with status &quot;pending&quot;).</p><h4 id="_4-approve-the-skill" tabindex="-1">4. Approve the Skill <a class="header-anchor" href="#_4-approve-the-skill" aria-label="Permalink to &quot;4. Approve the Skill&quot;">​</a></h4><p>In the <strong>Registry</strong> tab:</p><ol><li>Find &quot;hello-world&quot; in the table</li><li>Click the green checkmark button to approve</li><li>Enter your name/email and optional review notes</li><li>Click confirm</li></ol><p>The skill status changes to <strong>approved</strong>. Any AI assistant that checks this skill will now see it as approved.</p><h2 id="teaching-ai-assistants-to-use-skill-security" tabindex="-1">Teaching AI Assistants to Use Skill Security <a class="header-anchor" href="#teaching-ai-assistants-to-use-skill-security" aria-label="Permalink to &quot;Teaching AI Assistants to Use Skill Security&quot;">​</a></h2><p>The Skill Security Hub works best when AI assistants are <strong>instructed</strong> to use it. Here is how to set that up.</p><h3 id="adding-skill-security-awareness-to-your-ai-assistant" tabindex="-1">Adding Skill Security Awareness to Your AI Assistant <a class="header-anchor" href="#adding-skill-security-awareness-to-your-ai-assistant" aria-label="Permalink to &quot;Adding Skill Security Awareness to Your AI Assistant&quot;">​</a></h3><p>The easiest way to get the system prompt is from the <strong>Skill Security Hub dashboard</strong> in the Web Interface, it has a &quot;Copy to Clipboard&quot; button that gives you the prompt with the correct Gateway URL already filled in.</p><p>Alternatively, paste the following into your AI assistant&#39;s system prompt or instructions file (e.g., <code>CLAUDE.md</code> for Claude Code), replacing <code>&lt;SKILLS_MCP_GW&gt;</code> with your Gateway URL:</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Skill Security</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">You have access to the AI Security Gateway&#39;s Skill Security Hub via MCP located at http://&lt;SKILLS_MCP_GW&gt;/api/v1/mcp/skill-security.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">The gateway scans skills using 43 detection rules across 21 categories (227 patterns) covering:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote code execution, credential harvesting, obfuscated execution, malware delivery,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">crypto wallet theft, social engineering, URL impersonation, privilege escalation,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt injection, hardcoded secrets, resource abuse, and more.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### On Startup</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Run </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_skill_security_status\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> with the names of ALL currently installed skills/plugins (max 100 per call; batch if needed).</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">If any skill is not approved, do NOT execute it. Inform the user which skills need review.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Before Using Any New or Updated Skill</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">1.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Submit it for security analysis using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`analyze_skill\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (include full source code)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">2.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Check approval status using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`check_skill_approval\`</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">3.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Act based on the returned status:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`approved\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Safe to use</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`pending\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Do NOT execute. Awaiting admin review</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`rejected\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Do NOT execute. Admin has determined it is unsafe</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`quarantined\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Do NOT execute. Under investigation</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">   -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`unknown\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Not yet analyzed. Submit with </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`analyze_skill\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IMPORTANT: Approval is content-specific (SHA-256 hash). When a skill&#39;s source code changes,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">its status resets to pending even if previously approved. Always re-submit updated skills.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">You can browse approved skills using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`list_approved_skills\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (supports search, risk level, and category filters)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">and get full details on any skill using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_skill_details\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Monitoring Suspicious Behavior</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">If you observe suspicious behavior during skill execution:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unexpected network connections or direct IP URLs</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Attempts to read credentials, wallets, SSH keys, or seed phrases</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Base64-encoded commands piped to shell execution</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Downloads of executables or password-protected archives</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Crypto wallet access or transaction signing requests</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Social engineering pressure tactics (urgency, threats)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Behavior that doesn&#39;t match the skill&#39;s description</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Report it immediately using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`report_skill_activity\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> with one of these activity types:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`data_exfiltration\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Sending data to unexpected destinations</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`unexpected_network\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Unexpected network connections</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`privilege_escalation\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Attempting to escalate permissions</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`credential_access\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Attempting to access credentials or secrets</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`behavior_change\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -- Behavior changed from what was analyzed</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Only these activity types are accepted by the Gateway.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Periodic Security Checks</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Re-check installed skills periodically using </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_skill_security_status\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, especially:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> After skill updates or new installations</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> When the user asks about security posture</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> At the start of new sessions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### If the Gateway Is Unreachable</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">If MCP calls to the Gateway fail, default to strict mode:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Do NOT execute any unapproved or unverified skills</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Inform the user that the Skill Security Hub is unavailable</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Retry when connectivity is restored</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Available MCP Tools</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Tool | Purpose |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|---------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`analyze_skill\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Submit skill source code for security analysis. Returns risk score and detailed findings with file/line attribution. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`check_skill_approval\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Check if a skill is in the approved skills registry. Returns approval status and risk info. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`list_approved_skills\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | List skills in the registry with optional filters: category, risk_level, status, search text. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_skill_details\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Get full details for a specific skill: description, findings, review status, categories, and tags. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`report_skill_activity\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Report suspicious runtime behavior. Use one of: data_exfiltration, unexpected_network, privilege_escalation, credential_access, behavior_change. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_skill_security_status\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Get security posture for installed skills (max 100 per call). Returns approval status, risk scores, recommendations. |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`get_system_prompt\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | Get recommended system prompt instructions for skill security awareness. |</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Workflow</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">On Startup --&gt; get_skill_security_status (audit all installed skills)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">New/Updated Skill Detected</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">analyze_skill (submit source for scanning)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Risk Score + Findings returned (with file/line details)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">check_skill_approval</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      +--&gt; approved --&gt; Use skill, monitor for suspicious behavior</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      +--&gt; pending/rejected/quarantined/unknown --&gt; Do NOT use. Inform user.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      +--&gt; High risk + not yet approved --&gt; Warn user, wait for admin review</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">During execution: monitor for suspicious behavior</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">If suspicious --&gt; report_skill_activity</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Gateway unreachable? --&gt; Strict mode: refuse unapproved skills, inform user.</span></span></code></pre></div><p><strong>Tip</strong>: AI assistants can also call the <code>get_system_prompt</code> MCP tool to retrieve this template dynamically with the URL pre-configured.</p><h3 id="configuring-the-gateway-url" tabindex="-1">Configuring the Gateway URL <a class="header-anchor" href="#configuring-the-gateway-url" aria-label="Permalink to &quot;Configuring the Gateway URL&quot;">​</a></h3><p>By default, the system prompt template uses <code>http://localhost:8080/api/v1/mcp/skill-security</code>. To change this for remote deployments, set the <code>GATEWAY_URL</code> environment variable before starting the Gateway:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GATEWAY_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https://gateway.example.com</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./build/unified-admin</span></span></code></pre></div><h3 id="what-happens-when-the-assistant-uses-the-tools" tabindex="-1">What Happens When the Assistant Uses the Tools <a class="header-anchor" href="#what-happens-when-the-assistant-uses-the-tools" aria-label="Permalink to &quot;What Happens When the Assistant Uses the Tools&quot;">​</a></h3><p>Once configured, here is the typical flow:</p><p><strong>User</strong>: &quot;Install the web-scraper plugin and use it to fetch data from example.com&quot;</p><p><strong>Assistant</strong> (behind the scenes):</p><ol><li>Reads the plugin source code</li><li>Calls <code>analyze_skill</code> with the source code → gets risk score and findings</li><li>Calls <code>check_skill_approval</code> → sees it is not yet approved</li><li>Tells the user: <em>&quot;The web-scraper plugin has been submitted for security analysis. It scored 15 (Medium risk) due to HTTP client usage. It needs admin approval before I can use it.&quot;</em></li></ol><p><strong>Admin</strong>: Opens the Web Interface, reviews the findings, approves the skill with notes.</p><p><strong>Assistant</strong>: Next time it checks, <code>check_skill_approval</code> returns approved. Proceeds to use the skill.</p><h2 id="understanding-the-web-interface" tabindex="-1">Understanding the Web Interface <a class="header-anchor" href="#understanding-the-web-interface" aria-label="Permalink to &quot;Understanding the Web Interface&quot;">​</a></h2><h3 id="skill-security-dashboard-tab" tabindex="-1">Skill Security Dashboard Tab <a class="header-anchor" href="#skill-security-dashboard-tab" aria-label="Permalink to &quot;Skill Security Dashboard Tab&quot;">​</a></h3><p>The dashboard shows at a glance:</p><ul><li><strong>Total Skills</strong> in the registry</li><li><strong>Pending Review</strong> count (skills waiting for admin action)</li><li><strong>Approved / Rejected / Quarantined</strong> counts</li><li><strong>Risk Distribution</strong> — breakdown by risk level</li><li><strong>Top Submitting Agents</strong> — which AI assistants are submitting the most</li><li><strong>Recent Submissions</strong> — latest analysis results</li></ul><p><img src="`+r+'" alt="Dashboard"></p><h3 id="skill-security-submissions-tab" tabindex="-1">Skill Security Submissions Tab <a class="header-anchor" href="#skill-security-submissions-tab" aria-label="Permalink to &quot;Skill Security Submissions Tab&quot;">​</a></h3><p>Every time an AI assistant calls <code>analyze_skill</code>, a submission record is created. This tab shows:</p><ul><li><strong>Skill Name</strong> and <strong>Agent</strong> that submitted it</li><li><strong>Risk Level</strong> with color-coded badge (Critical=red, High=orange, Medium=yellow, Low=green, None=gray)</li><li><strong>Findings Count</strong> — number of security patterns detected</li><li><strong>Status</strong> — <code>analyzed</code> or <code>linked_to_approved</code></li><li><strong>Date</strong> of submission</li></ul><p>Click a row to expand and see the full findings detail, including which specific patterns were matched and their severity.</p><p><img src="'+h+'" alt="Submissions Table"></p><h3 id="skill-security-registry-tab" tabindex="-1">Skill Security Registry Tab <a class="header-anchor" href="#skill-security-registry-tab" aria-label="Permalink to &quot;Skill Security Registry Tab&quot;">​</a></h3><p>The registry is the <strong>source of truth</strong> for skill approvals. Each unique skill (by name + version) gets one registry entry.</p><p><strong>Status workflow</strong>:</p><ul><li><strong>Pending</strong> → Skill has been submitted but not reviewed</li><li><strong>Approved</strong> → Admin has reviewed and approved for use</li><li><strong>Rejected</strong> → Admin has reviewed and rejected</li><li><strong>Quarantined</strong> → Admin has flagged for further investigation</li></ul><p><strong>Admin actions</strong> (visible to users with admin role):</p><ul><li><strong>Approve</strong> (green checkmark) — Mark skill as safe to use</li><li><strong>Reject</strong> (red X) — Mark skill as unsafe</li><li><strong>Quarantine</strong> (orange shield) — Flag for investigation</li><li><strong>Delete</strong> (trash icon) — Remove from registry entirely</li></ul><p><img src="'+p+'" alt="Registry Table"></p><h3 id="skill-security-activity-reports-tab" tabindex="-1">Skill Security Activity Reports Tab <a class="header-anchor" href="#skill-security-activity-reports-tab" aria-label="Permalink to &quot;Skill Security Activity Reports Tab&quot;">​</a></h3><p>When AI assistants call <code>report_skill_activity</code>, the reports appear here. Each report includes:</p><ul><li><strong>Skill Name</strong> that exhibited suspicious behavior</li><li><strong>Activity Type</strong> (data exfiltration, unexpected network, privilege escalation, etc.)</li><li><strong>Agent</strong> that reported it</li><li><strong>Severity</strong> of the report</li><li><strong>Alert Created</strong> — whether the Gateway automatically created a security alert</li></ul><p>Reports at medium severity or higher automatically create security alerts that also appear in the main Alerts dashboard. All alerts created from MCP-submitted reports are tagged with <code>[Unverified MCP Report]</code> so admins can distinguish agent-submitted reports from admin-verified alerts.</p><p><img src="'+o+`" alt="Report Acitvity"></p><h2 id="understanding-risk-scores-and-findings" tabindex="-1">Understanding Risk Scores and Findings <a class="header-anchor" href="#understanding-risk-scores-and-findings" aria-label="Permalink to &quot;Understanding Risk Scores and Findings&quot;">​</a></h2><h3 id="what-gets-detected" tabindex="-1">What Gets Detected <a class="header-anchor" href="#what-gets-detected" aria-label="Permalink to &quot;What Gets Detected&quot;">​</a></h3><p>The Gateway scans skill source code for 9 categories of suspicious patterns:</p><table tabindex="0"><thead><tr><th>Category</th><th>Severity</th><th>Examples</th></tr></thead><tbody><tr><td>Shell Execution</td><td>Critical</td><td>Running shell commands, piping downloads to bash</td></tr><tr><td>Dynamic Code Construction</td><td>Critical</td><td>Runtime code generation, dynamic imports</td></tr><tr><td>Credential Harvesting</td><td>Critical</td><td>Reading SSH keys, AWS credentials, environment variables</td></tr><tr><td>Obfuscated Payloads</td><td>High</td><td>Base64-encoded code, hex escape chains</td></tr><tr><td>Reverse Shells</td><td>Critical</td><td>Netcat connections, TCP redirects</td></tr><tr><td>Dynamic Content Loading</td><td>Medium</td><td>HTTP requests (fetch, requests, axios)</td></tr><tr><td>Filesystem Snooping</td><td>High</td><td>Reading sensitive paths, directory scanning</td></tr><tr><td>Persistence Mechanisms</td><td>Critical</td><td>Crontab entries, system service registration</td></tr><tr><td>C2 Communication</td><td>Critical</td><td>Polling loops, DNS tunneling, .onion addresses</td></tr></tbody></table><h3 id="interpreting-risk-scores" tabindex="-1">Interpreting Risk Scores <a class="header-anchor" href="#interpreting-risk-scores" aria-label="Permalink to &quot;Interpreting Risk Scores&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Risk Level</th><th>Score</th><th>What It Means</th><th>Recommended Action</th></tr></thead><tbody><tr><td><strong>None</strong></td><td>0</td><td>No suspicious patterns found</td><td>Safe to approve</td></tr><tr><td><strong>Low</strong></td><td>1-14</td><td>Minor patterns detected</td><td>Review and likely approve</td></tr><tr><td><strong>Medium</strong></td><td>15-29</td><td>Notable patterns (e.g., HTTP calls)</td><td>Review findings carefully before approving</td></tr><tr><td><strong>High</strong></td><td>30-49</td><td>Significant risk indicators</td><td>Review thoroughly, document justification if approving</td></tr><tr><td><strong>Critical</strong></td><td>50+</td><td>Highly suspicious patterns</td><td>Investigate thoroughly, consider rejecting</td></tr></tbody></table><h3 id="when-to-approve-a-high-risk-skill" tabindex="-1">When to Approve a High-Risk Skill <a class="header-anchor" href="#when-to-approve-a-high-risk-skill" aria-label="Permalink to &quot;When to Approve a High-Risk Skill&quot;">​</a></h3><p>Not all findings indicate malicious intent. A legitimate file manager skill will trigger &quot;Shell Execution&quot; findings because it needs to run commands. A web scraper will trigger &quot;Dynamic Content Loading&quot; because it needs to make HTTP requests.</p><p><strong>Approve with notes</strong> when:</p><ul><li>The findings match the skill&#39;s stated purpose</li><li>The author is trusted</li><li>The source code has been manually reviewed</li></ul><p><strong>Reject</strong> when:</p><ul><li>Findings don&#39;t match the skill&#39;s stated purpose (e.g., a &quot;calculator&quot; skill that makes network requests)</li><li>Multiple critical categories triggered</li><li>Obfuscation patterns detected (skills should not need to hide their behavior)</li><li>Credential harvesting patterns in a skill that shouldn&#39;t need credentials</li></ul><h2 id="workflow-scenarios" tabindex="-1">Workflow Scenarios <a class="header-anchor" href="#workflow-scenarios" aria-label="Permalink to &quot;Workflow Scenarios&quot;">​</a></h2><h3 id="scenario-1-new-skill-onboarding" tabindex="-1">Scenario 1: New Skill Onboarding <a class="header-anchor" href="#scenario-1-new-skill-onboarding" aria-label="Permalink to &quot;Scenario 1: New Skill Onboarding&quot;">​</a></h3><ol><li>Developer creates a new MCP skill</li><li>AI assistant submits it via <code>analyze_skill</code></li><li>Gateway scans and returns findings</li><li>Admin reviews in Web Interface: <ul><li>Low/None risk → Approve immediately</li><li>Medium risk → Review findings, approve with notes</li><li>High/Critical risk → Investigate source code, approve with justification or reject</li></ul></li><li>AI assistant calls <code>check_skill_approval</code> → gets approval status</li></ol><h3 id="scenario-2-skill-update-detection" tabindex="-1">Scenario 2: Skill Update Detection <a class="header-anchor" href="#scenario-2-skill-update-detection" aria-label="Permalink to &quot;Scenario 2: Skill Update Detection&quot;">​</a></h3><p>When a skill&#39;s source code changes:</p><ol><li>AI assistant submits the updated version via <code>analyze_skill</code></li><li>Gateway detects new SHA-256 hash (different from previously approved version)</li><li>Skill status resets to <strong>pending</strong> — requires re-approval</li><li>Admin reviews the updated version</li></ol><p>This prevents &quot;bait-and-switch&quot; attacks where a skill passes review, then updates with malicious code.</p><h3 id="scenario-3-runtime-behavior-monitoring" tabindex="-1">Scenario 3: Runtime Behavior Monitoring <a class="header-anchor" href="#scenario-3-runtime-behavior-monitoring" aria-label="Permalink to &quot;Scenario 3: Runtime Behavior Monitoring&quot;">​</a></h3><ol><li>AI assistant executes an approved skill</li><li>Skill makes unexpected outbound HTTP connection to an unknown IP</li><li>AI assistant calls <code>report_skill_activity</code> with type <code>unexpected_network</code></li><li>Gateway creates a security alert (for high-severity reports)</li><li>Admin sees the alert in both the Activity Reports tab and the main Alerts dashboard</li><li>Admin can quarantine the skill while investigating</li></ol><h3 id="scenario-4-security-posture-audit" tabindex="-1">Scenario 4: Security Posture Audit <a class="header-anchor" href="#scenario-4-security-posture-audit" aria-label="Permalink to &quot;Scenario 4: Security Posture Audit&quot;">​</a></h3><ol><li>Admin asks AI assistant: &quot;What is your current skill security status?&quot;</li><li>AI assistant calls <code>get_skill_security_status</code> with all installed skill names</li><li>Returns: 8 skills installed, 6 approved, 1 pending, 1 unknown</li><li>AI assistant reports this to the admin with recommendations</li></ol><h2 id="common-questions" tabindex="-1">Common Questions <a class="header-anchor" href="#common-questions" aria-label="Permalink to &quot;Common Questions&quot;">​</a></h2><h3 id="do-ai-assistants-submit-skills-automatically" tabindex="-1">Do AI assistants submit skills automatically? <a class="header-anchor" href="#do-ai-assistants-submit-skills-automatically" aria-label="Permalink to &quot;Do AI assistants submit skills automatically?&quot;">​</a></h3><p>No. AI assistants must be <strong>instructed</strong> to use the Skill Security tools (via system prompt or instructions). Without instructions, they won&#39;t know to submit skills. See the &quot;Teaching AI Assistants&quot; section above.</p><h3 id="what-counts-as-skill-source-code" tabindex="-1">What counts as &quot;skill source code&quot;? <a class="header-anchor" href="#what-counts-as-skill-source-code" aria-label="Permalink to &quot;What counts as &quot;skill source code&quot;?&quot;">​</a></h3><p>Anything that defines the skill&#39;s behavior:</p><ul><li>Python, JavaScript, Go, or any other source code</li><li>MCP server configuration files</li><li>Plugin manifest/definition files</li><li>Tool schemas with implementation details</li></ul><p>The more complete the source, the better the analysis. Submit the full implementation, not just a summary.</p><h3 id="is-there-a-default-skill-already-in-the-registry" tabindex="-1">Is there a default skill already in the registry? <a class="header-anchor" href="#is-there-a-default-skill-already-in-the-registry" aria-label="Permalink to &quot;Is there a default skill already in the registry?&quot;">​</a></h3><p>Yes. On first startup, the Gateway automatically seeds a pre-approved skill called <code>skill-security-hub</code> (v1.0.0). This skill contains the system prompt template and serves as a reference entry so the registry is not empty when you first open the Web Interface.</p><h3 id="can-i-pre-approve-skills-before-ai-assistants-use-them" tabindex="-1">Can I pre-approve skills before AI assistants use them? <a class="header-anchor" href="#can-i-pre-approve-skills-before-ai-assistants-use-them" aria-label="Permalink to &quot;Can I pre-approve skills before AI assistants use them?&quot;">​</a></h3><p>Yes. You can submit skills via curl (see Quick Start) or any MCP client, then approve them in the Web Interface before any AI assistant needs them. When the assistant later calls <code>check_skill_approval</code>, it will already be approved.</p><h3 id="what-happens-if-the-gateway-is-down" tabindex="-1">What happens if the Gateway is down? <a class="header-anchor" href="#what-happens-if-the-gateway-is-down" aria-label="Permalink to &quot;What happens if the Gateway is down?&quot;">​</a></h3><p>If the Gateway is unreachable, the AI assistant&#39;s MCP calls will fail. The system prompt template instructs AI assistants to default to <strong>strict mode</strong>: refuse all unapproved or unverified skills when the Gateway is unreachable, inform the user, and retry when connectivity is restored. This is the recommended and default behavior for all environments.</p><h3 id="can-i-use-this-without-ai-assistants" tabindex="-1">Can I use this without AI assistants? <a class="header-anchor" href="#can-i-use-this-without-ai-assistants" aria-label="Permalink to &quot;Can I use this without AI assistants?&quot;">​</a></h3><p>Yes. The MCP endpoint accepts standard HTTP POST requests. You can build scripts or CI/CD pipelines that submit skills for analysis using curl or any HTTP client. See the Technical Integration Guide for examples.</p><h3 id="how-do-i-submit-a-skill-that-is-a-file-on-disk" tabindex="-1">How do I submit a skill that is a file on disk? <a class="header-anchor" href="#how-do-i-submit-a-skill-that-is-a-file-on-disk" aria-label="Permalink to &quot;How do I submit a skill that is a file on disk?&quot;">​</a></h3><p>Read the file content and pass it as the <code>skill_source</code> parameter:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Read file and submit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SKILL_CONTENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/skill.py</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/mcp/skill-security</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --arg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> source &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$SKILL_CONTENT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      jsonrpc: &quot;2.0&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      id: 1,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      method: &quot;tools/call&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      params: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        name: &quot;analyze_skill&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        arguments: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          skill_name: &quot;my-skill&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          skill_source: $source,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          agent_name: &quot;manual-submission&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }&#39;)&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span></span></code></pre></div><h3 id="can-multiple-ai-assistants-share-the-same-approval-registry" tabindex="-1">Can multiple AI assistants share the same approval registry? <a class="header-anchor" href="#can-multiple-ai-assistants-share-the-same-approval-registry" aria-label="Permalink to &quot;Can multiple AI assistants share the same approval registry?&quot;">​</a></h3><p>Yes. The registry is centralized in the Gateway. Once an admin approves a skill, <strong>any</strong> AI assistant that checks that skill name will see it as approved. This is by design — approve once, used everywhere.</p><h2 id="security-best-practices" tabindex="-1">Security Best Practices <a class="header-anchor" href="#security-best-practices" aria-label="Permalink to &quot;Security Best Practices&quot;">​</a></h2><ol><li><p><strong>Require approval before execution</strong> — Configure AI assistants to always check <code>check_skill_approval</code> before running any skill.</p></li><li><p><strong>Review Critical findings carefully</strong> — A Critical risk score does not always mean malicious, but it always warrants manual review of the source code.</p></li><li><p><strong>Use quarantine for investigation</strong> — When a skill&#39;s behavior is unclear, quarantine it while you investigate. This prevents AI assistants from using it without deleting the analysis data.</p></li><li><p><strong>Monitor Activity Reports</strong> — Runtime behavior reports from AI assistants are early warning signs. Investigate them promptly.</p></li><li><p><strong>Re-review after updates</strong> — When a skill&#39;s content hash changes, the Gateway resets it to pending. Always review updated versions, even if the previous version was approved.</p></li><li><p><strong>Document approval decisions</strong> — Use the review notes field to explain why a skill was approved despite risk findings. This creates an audit trail.</p></li><li><p><strong>Periodic security audits</strong> — Use <code>get_skill_security_status</code> to periodically check that all installed skills are still approved and haven&#39;t changed.</p></li></ol>`,118)])])}const b=i(k,[["render",d]]);export{m as __pageData,b as default};
