import{_ as i,o as a,c as t,ah as e}from"./chunks/framework.504LQ1l3.js";const n="/assets/redact-rule-01.-3NRAn3R.png",l="/assets/apply-redact-policy-01.CgjIp3S3.png",r="/assets/audit-logs-redaction-01.AHNky0TZ.png",o="/assets/alerts-redaction-01.jnA77ZsC.png",y=JSON.parse('{"title":"Data Masking and Redaction","description":"","frontmatter":{},"headers":[],"relativePath":"features/data-masking-redaction.md","filePath":"features/data-masking-redaction.md"}'),p={name:"features/data-masking-redaction.md"};function h(k,s,d,c,g,u){return a(),t("div",null,[...s[0]||(s[0]=[e('<h1 id="data-masking-and-redaction" tabindex="-1">Data Masking and Redaction <a class="header-anchor" href="#data-masking-and-redaction" aria-label="Permalink to &quot;Data Masking and Redaction&quot;">​</a></h1><p>The AI Security Gateway provides comprehensive data masking and redaction capabilities to protect sensitive information when communicating with LLM providers. This feature automatically detects and masks sensitive data patterns before sending requests to external APIs, while maintaining the ability to unmask responses for the user.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Data masking and redaction is a critical security feature that:</p><ul><li><strong>Protects sensitive data</strong> by masking it before transmission to LLM providers</li><li><strong>Maintains functionality</strong> by preserving the structure and context of requests</li><li><strong>Provides transparency</strong> through comprehensive audit logging</li><li><strong>Enables compliance</strong> with data protection regulations (GDPR, HIPAA, etc.)</li><li><strong>Supports custom patterns</strong> for organization-specific sensitive data</li></ul><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">​</a></h2><p>The data masking system operates in three stages:</p><ol><li><strong>Request Masking</strong>: Sensitive patterns are detected and replaced with redaction placeholders before sending to the LLM</li><li><strong>Response Processing</strong>: LLM responses are processed normally</li><li><strong>Response Unmasking</strong> (optional): Redaction placeholders in responses are replaced with original values when returning to users</li></ol><h2 id="setting-up-redaction-rules" tabindex="-1">Setting Up Redaction Rules <a class="header-anchor" href="#setting-up-redaction-rules" aria-label="Permalink to &quot;Setting Up Redaction Rules&quot;">​</a></h2><h3 id="step-1-create-a-redaction-policy" tabindex="-1">Step 1: Create a Redaction Policy <a class="header-anchor" href="#step-1-create-a-redaction-policy" aria-label="Permalink to &quot;Step 1: Create a Redaction Policy&quot;">​</a></h3><p>Redaction rules are defined within security policies. You can either create a new policy or modify an existing one.</p><p><img src="'+n+`" alt="Redaction Rule"></p><p><strong>Example Redaction Rule Configuration:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;llm-data-redaction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;redaction_rules&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Secret Password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;pattern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;super_s3cr3t_password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;replacement&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[REDACTED_PASSWORD]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;case_sensitive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Credit Card Numbers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;pattern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3[0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;replacement&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[REDACTED_CC]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;case_sensitive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Email Addresses&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;pattern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.[A-Z|a-z]{2,}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;replacement&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[REDACTED_EMAIL]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;case_sensitive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;unmask_for_user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="key-configuration-options" tabindex="-1">Key Configuration Options <a class="header-anchor" href="#key-configuration-options" aria-label="Permalink to &quot;Key Configuration Options&quot;">​</a></h3><ul><li><strong>Pattern</strong>: Regular expression or literal string to match sensitive data</li><li><strong>Replacement</strong>: The redaction placeholder that replaces matched content</li><li><strong>Case Sensitive</strong>: Whether pattern matching is case sensitive</li><li><strong>Unmask for User</strong>: Whether to restore original values in responses</li></ul><h3 id="step-2-enable-unmask-for-user-feature" tabindex="-1">Step 2: Enable &quot;Unmask for User&quot; Feature <a class="header-anchor" href="#step-2-enable-unmask-for-user-feature" aria-label="Permalink to &quot;Step 2: Enable &quot;Unmask for User&quot; Feature&quot;">​</a></h3><p>When creating or editing a redaction rule, enable the <strong>&quot;Unmask for user&quot;</strong> option:</p><p><strong>Purpose</strong>: When enabled, sensitive data is masked with placeholders before sending to the LLM provider, then automatically unmasked in the response before returning to the user.</p><p><strong>Benefits</strong>:</p><ul><li>✅ <strong>Privacy Protection</strong>: Sensitive data never leaves your environment</li><li>✅ <strong>Functionality Preservation</strong>: Users receive complete, unmasked responses</li><li>✅ <strong>Zero Impact</strong>: Transparent operation with no user experience degradation</li><li>✅ <strong>Compliance</strong>: Meets data protection requirements while maintaining usability</li></ul><h3 id="step-3-apply-policy-to-proxy" tabindex="-1">Step 3: Apply Policy to Proxy <a class="header-anchor" href="#step-3-apply-policy-to-proxy" aria-label="Permalink to &quot;Step 3: Apply Policy to Proxy&quot;">​</a></h3><p>Once your redaction policy is configured, apply it to the desired proxy instance.</p><p><img src="`+l+`" alt="Apply to Proxy"></p><p><strong>To apply the policy:</strong></p><ol><li>Navigate to the <strong>Proxies</strong> dashboard</li><li>Select the proxy you want to protect</li><li>Click <strong>&quot;Policies&quot;</strong></li><li>Add your redaction policy (e.g., <code>llm-data-redaction</code>) to <strong>Requests</strong></li><li>Save the configuration</li><li>Restart the proxy if required</li></ol><h2 id="testing-redaction" tabindex="-1">Testing Redaction <a class="header-anchor" href="#testing-redaction" aria-label="Permalink to &quot;Testing Redaction&quot;">​</a></h2><h3 id="step-4-send-test-request" tabindex="-1">Step 4: Send Test Request <a class="header-anchor" href="#step-4-send-test-request" aria-label="Permalink to &quot;Step 4: Send Test Request&quot;">​</a></h3><p>Test the redaction functionality by sending a request containing sensitive data through the proxy:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8030/v1/chat/completions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer your-api-key&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;model&quot;: &quot;gpt-4&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;messages&quot;: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;role&quot;: &quot;user&quot;, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;content&quot;: &quot;dont tell anyone, but my password is: super_s3cr3t_password&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }&#39;</span></span></code></pre></div><h3 id="step-5-verify-redaction-in-audit-logs" tabindex="-1">Step 5: Verify Redaction in Audit Logs <a class="header-anchor" href="#step-5-verify-redaction-in-audit-logs" aria-label="Permalink to &quot;Step 5: Verify Redaction in Audit Logs&quot;">​</a></h3><p>Navigate to the <strong>Audit Logs</strong> section to confirm the redaction occurred:</p><p><img src="`+r+'" alt="Audit Logs Redaction"></p><p><strong>What to verify:</strong></p><ul><li>✅ Request logged shows <code>[REDACTED_PASSWORD_1]</code> instead of actual password</li><li>✅ Email addresses replaced with <code>[REDACTED_EMAIL_1]</code>, <code>[REDACTED_EMAIL_2]</code> etc if added to request.</li><li>✅ Timestamp and proxy information recorded</li><li>✅ Redaction rule name and policy identified</li></ul><h3 id="step-6-monitor-security-alerts" tabindex="-1">Step 6: Monitor Security Alerts <a class="header-anchor" href="#step-6-monitor-security-alerts" aria-label="Permalink to &quot;Step 6: Monitor Security Alerts&quot;">​</a></h3><p>Check the <strong>Alerts</strong> dashboard to see redaction rule triggers and security events:</p><p><img src="'+o+'" alt="Alerts Dashboard Redaction"></p><p><strong>Alert Information Includes:</strong></p><ul><li><strong>Alert Type</strong>: Redaction rule triggered</li><li><strong>Severity Level</strong>: Based on data sensitivity</li><li><strong>Matched Pattern</strong>: Which redaction rule was activated</li><li><strong>Proxy Instance</strong>: Where the redaction occurred</li><li><strong>Timestamp</strong>: When the event was detected</li><li><strong>Action Taken</strong>: Confirmation of successful masking</li></ul><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="common-issues" tabindex="-1">Common Issues <a class="header-anchor" href="#common-issues" aria-label="Permalink to &quot;Common Issues&quot;">​</a></h3><p><strong>Redaction Not Working:</strong></p><ul><li>✅ Verify policy is applied to the correct proxy</li><li>✅ Check regex pattern syntax</li><li>✅ Ensure proxy has been restarted after policy changes</li><li>✅ Confirm policy is enabled and not in test mode</li></ul><p><strong>Performance Impact:</strong></p><ul><li>✅ Optimize regex patterns for efficiency</li><li>✅ Limit the number of concurrent redaction rules</li><li>✅ Use more specific patterns to reduce false positives</li><li>✅ Consider proxy-specific vs global policy application</li></ul><p><strong>False Positives:</strong></p><ul><li>✅ Refine regex patterns to be more specific</li><li>✅ Use negative lookahead/lookbehind assertions</li><li>✅ Test patterns thoroughly before production deployment</li><li>✅ Monitor audit logs for unexpected matches</li></ul><h2 id="security-best-practices" tabindex="-1">Security Best Practices <a class="header-anchor" href="#security-best-practices" aria-label="Permalink to &quot;Security Best Practices&quot;">​</a></h2><ol><li><strong>Regular Pattern Updates</strong>: Keep redaction patterns current with evolving data formats</li><li><strong>Testing</strong>: Thoroughly test new patterns before production deployment</li><li><strong>Monitoring</strong>: Continuously monitor for new sensitive data patterns</li><li><strong>Access Control</strong>: Restrict who can modify redaction policies</li><li><strong>Backup</strong>: Maintain backups of effective redaction configurations</li><li><strong>Documentation</strong>: Document all custom patterns and their business justification</li></ol>',50)])])}const F=i(p,[["render",h]]);export{y as __pageData,F as default};
