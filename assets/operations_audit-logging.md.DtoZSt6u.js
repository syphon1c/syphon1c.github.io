import{_ as i,o as e,c as a,ah as s}from"./chunks/framework.504LQ1l3.js";const n="/assets/audit-system-log-viewer-02.C0HutivL.png",u=JSON.parse('{"title":"Comprehensive Audit Logging","description":"","frontmatter":{},"headers":[],"relativePath":"operations/audit-logging.md","filePath":"operations/audit-logging.md"}'),o={name:"operations/audit-logging.md"};function l(r,t,d,h,p,g){return e(),a("div",null,[...t[0]||(t[0]=[s('<h1 id="comprehensive-audit-logging" tabindex="-1">Comprehensive Audit Logging <a class="header-anchor" href="#comprehensive-audit-logging" aria-label="Permalink to &quot;Comprehensive Audit Logging&quot;">​</a></h1><p>The AI Security Gateway includes enterprise-grade audit logging that tracks all security-sensitive operations for compliance, security monitoring, and incident response.</p><p><img src="'+n+`" alt="Audit Log Viewer"></p><h2 id="audit-logging-overview" tabindex="-1">Audit Logging Overview <a class="header-anchor" href="#audit-logging-overview" aria-label="Permalink to &quot;Audit Logging Overview&quot;">​</a></h2><p>The audit logging system provides:</p><ul><li><strong>35+ event types</strong> covering authentication, user management, resource operations, and security events</li><li><strong>Structured JSON output</strong> for integration with SIEM/SOAR systems</li><li><strong>Complete attribution</strong> with user ID, username, email, role, IP address, and user agent</li><li><strong>Severity levels</strong> (info, warning, critical) for prioritization</li><li><strong>Compliance ready</strong> for SOC 2, HIPAA, GDPR, and PCI DSS requirements</li></ul><h2 id="how-audit-logging-works" tabindex="-1">How Audit Logging Works <a class="header-anchor" href="#how-audit-logging-works" aria-label="Permalink to &quot;How Audit Logging Works&quot;">​</a></h2><h3 id="core-capabilities" tabindex="-1">Core Capabilities <a class="header-anchor" href="#core-capabilities" aria-label="Permalink to &quot;Core Capabilities&quot;">​</a></h3><ul><li><strong>Automatic Tracking</strong> - All security-sensitive operations are automatically logged</li><li><strong>Dual Output</strong> - Logs available in both human-readable and JSON formats</li><li><strong>Structured Data</strong> - Every event includes timestamp, user details, action, result, and context</li><li><strong>Integration Ready</strong> - JSON format designed for SIEM/SOAR system integration</li></ul><h3 id="what-gets-logged" tabindex="-1">What Gets Logged <a class="header-anchor" href="#what-gets-logged" aria-label="Permalink to &quot;What Gets Logged&quot;">​</a></h3><p>Every audit event captures:</p><ul><li><strong>Who</strong>: User ID, username, email, role</li><li><strong>What</strong>: Action performed and resource affected</li><li><strong>When</strong>: Precise timestamp (UTC)</li><li><strong>Where</strong>: Source IP address and user agent</li><li><strong>Result</strong>: Success, failure, or partial completion</li><li><strong>Why</strong>: Context and additional details</li><li><strong>Severity</strong>: Info, warning, or critical priority</li></ul><h2 id="event-types" tabindex="-1">Event Types <a class="header-anchor" href="#event-types" aria-label="Permalink to &quot;Event Types&quot;">​</a></h2><h3 id="authentication-events-6-types" tabindex="-1">Authentication Events (6 types) <a class="header-anchor" href="#authentication-events-6-types" aria-label="Permalink to &quot;Authentication Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>auth.login</code></td><td>Successful user login</td><td>info</td></tr><tr><td><code>auth.login.failed</code></td><td>Failed login attempt</td><td>warning</td></tr><tr><td><code>auth.logout</code></td><td>User logout</td><td>info</td></tr><tr><td><code>auth.token.refresh</code></td><td>JWT token refresh</td><td>info</td></tr><tr><td><code>auth.password.change</code></td><td>User password change</td><td>info</td></tr><tr><td><code>auth.password.reset</code></td><td>Admin password reset</td><td>warning</td></tr></tbody></table><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:23:45 INFO [audit] [AUDIT] [auth.login] admin (ID:1) auth.login - authentication:admin - Result: success | User logged in successfully with role: admin | IP: 192.168.1.100</span></span></code></pre></div><h3 id="user-management-events-6-types" tabindex="-1">User Management Events (6 types) <a class="header-anchor" href="#user-management-events-6-types" aria-label="Permalink to &quot;User Management Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>user.created</code></td><td>New user account created</td><td>info</td></tr><tr><td><code>user.updated</code></td><td>User profile modified</td><td>info</td></tr><tr><td><code>user.deleted</code></td><td>User account deleted</td><td>warning</td></tr><tr><td><code>user.deactivated</code></td><td>User account deactivated</td><td>warning</td></tr><tr><td><code>user.activated</code></td><td>User account reactivated</td><td>info</td></tr><tr><td><code>user.role.changed</code></td><td>User role modified</td><td>warning</td></tr></tbody></table><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:25:30 INFO [audit] [AUDIT] [user.created] admin (ID:1) create user - user:42 (john.doe) - Result: success | Created user &#39;john.doe&#39; with role &#39;user&#39; | IP: 192.168.1.100</span></span></code></pre></div><h3 id="api-key-events-5-types" tabindex="-1">API Key Events (5 types) <a class="header-anchor" href="#api-key-events-5-types" aria-label="Permalink to &quot;API Key Events (5 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>apikey.created</code></td><td>API key generated</td><td>info</td></tr><tr><td><code>apikey.updated</code></td><td>API key modified</td><td>info</td></tr><tr><td><code>apikey.deleted</code></td><td>API key deleted</td><td>warning</td></tr><tr><td><code>apikey.revoked</code></td><td>API key revoked</td><td>warning</td></tr><tr><td><code>apikey.used</code></td><td>API key authenticated</td><td>info</td></tr></tbody></table><h3 id="user-group-events-5-types" tabindex="-1">User Group Events (5 types) <a class="header-anchor" href="#user-group-events-5-types" aria-label="Permalink to &quot;User Group Events (5 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>usergroup.created</code></td><td>User group created</td><td>info</td></tr><tr><td><code>usergroup.updated</code></td><td>User group modified</td><td>info</td></tr><tr><td><code>usergroup.deleted</code></td><td>User group deleted</td><td>warning</td></tr><tr><td><code>usergroup.access.added</code></td><td>Member added to group</td><td>info</td></tr><tr><td><code>usergroup.access.removed</code></td><td>Member removed from group</td><td>info</td></tr></tbody></table><h3 id="proxy-lifecycle-events-6-types" tabindex="-1">Proxy Lifecycle Events (6 types) <a class="header-anchor" href="#proxy-lifecycle-events-6-types" aria-label="Permalink to &quot;Proxy Lifecycle Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>proxy.created</code></td><td>Proxy configuration created</td><td>info</td></tr><tr><td><code>proxy.updated</code></td><td>Proxy settings modified</td><td>info</td></tr><tr><td><code>proxy.deleted</code></td><td>Proxy configuration removed</td><td>warning</td></tr><tr><td><code>proxy.started</code></td><td>Proxy instance started</td><td>info</td></tr><tr><td><code>proxy.stopped</code></td><td>Proxy instance stopped</td><td>info</td></tr><tr><td><code>proxy.restarted</code></td><td>Proxy instance restarted</td><td>info</td></tr></tbody></table><h3 id="policy-assignment-events-4-types" tabindex="-1">Policy Assignment Events (4 types) <a class="header-anchor" href="#policy-assignment-events-4-types" aria-label="Permalink to &quot;Policy Assignment Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>policy.assigned</code></td><td>Security policy assigned to proxy</td><td>info</td></tr><tr><td><code>policy.unassigned</code></td><td>Security policy removed from proxy</td><td>info</td></tr><tr><td><code>policy.bulk.assigned</code></td><td>Multiple policies assigned</td><td>info</td></tr><tr><td><code>policy.assignment.updated</code></td><td>Policy assignment modified</td><td>info</td></tr></tbody></table><h3 id="mcp-tool-events-4-types" tabindex="-1">MCP Tool Events (4 types) <a class="header-anchor" href="#mcp-tool-events-4-types" aria-label="Permalink to &quot;MCP Tool Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>mcp.tool.enabled</code></td><td>MCP tool enabled</td><td>info</td></tr><tr><td><code>mcp.tool.disabled</code></td><td>MCP tool disabled</td><td>info</td></tr><tr><td><code>mcp.tool.bulk.updated</code></td><td>Multiple tools updated</td><td>info</td></tr><tr><td><code>mcp.tool.discovered</code></td><td>Tools discovered from MCP server</td><td>info</td></tr></tbody></table><h3 id="oauth-provider-events-4-types" tabindex="-1">OAuth Provider Events (4 types) <a class="header-anchor" href="#oauth-provider-events-4-types" aria-label="Permalink to &quot;OAuth Provider Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>oauth.provider.created</code></td><td>OAuth provider configured</td><td>info</td></tr><tr><td><code>oauth.provider.updated</code></td><td>OAuth provider modified</td><td>info</td></tr><tr><td><code>oauth.provider.deleted</code></td><td>OAuth provider removed</td><td>warning</td></tr><tr><td><code>oauth.session.revoked</code></td><td>OAuth session revoked</td><td>warning</td></tr></tbody></table><h3 id="security-events-4-types" tabindex="-1">Security Events (4 types) <a class="header-anchor" href="#security-events-4-types" aria-label="Permalink to &quot;Security Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>security.access.denied</code></td><td>Unauthorized access attempt</td><td>critical</td></tr><tr><td><code>security.input.invalid</code></td><td>Invalid input detected</td><td>warning</td></tr><tr><td><code>security.ratelimit.exceeded</code></td><td>Rate limit violation</td><td>warning</td></tr><tr><td><code>security.suspicious.activity</code></td><td>Suspicious behavior detected</td><td>critical</td></tr></tbody></table><h2 id="log-format" tabindex="-1">Log Format <a class="header-anchor" href="#log-format" aria-label="Permalink to &quot;Log Format&quot;">​</a></h2><h3 id="human-readable-format" tabindex="-1">Human-Readable Format <a class="header-anchor" href="#human-readable-format" aria-label="Permalink to &quot;Human-Readable Format&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[TIMESTAMP] [LEVEL] [COMPONENT] [AUDIT] [EVENT_TYPE] ACTOR ACTION - RESOURCE - Result: RESULT | DETAILS | IP: SOURCE_IP</span></span></code></pre></div><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:23:45 INFO [AI Security Gateway] [audit] [AUDIT] [auth.login] admin (ID:1) auth.login - authentication:admin - Result: success | User logged in successfully with role: admin | IP: 192.168.1.100</span></span></code></pre></div><h3 id="json-format-siem-integration" tabindex="-1">JSON Format (SIEM Integration) <a class="header-anchor" href="#json-format-siem-integration" aria-label="Permalink to &quot;JSON Format (SIEM Integration)&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth.login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-10-28T14:23:45Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;severity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;actor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin@localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;role&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;authentication&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth.login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;details&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;User logged in successfully with role: admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;metadata&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;source_ip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.1.100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_agent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mozilla/5.0...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error_message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="audit-logging-usage-examples" tabindex="-1">Audit Logging Usage Examples <a class="header-anchor" href="#audit-logging-usage-examples" aria-label="Permalink to &quot;Audit Logging Usage Examples&quot;">​</a></h2><h3 id="querying-audit-logs" tabindex="-1">Querying Audit Logs <a class="header-anchor" href="#querying-audit-logs" aria-label="Permalink to &quot;Querying Audit Logs&quot;">​</a></h3><h4 id="find-all-failed-login-attempts" tabindex="-1">Find all failed login attempts <a class="header-anchor" href="#find-all-failed-login-attempts" aria-label="Permalink to &quot;Find all failed login attempts&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.login.failed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="track-actions-by-specific-user" tabindex="-1">Track actions by specific user <a class="header-anchor" href="#track-actions-by-specific-user" aria-label="Permalink to &quot;Track actions by specific user&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;admin (ID:1)&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUDIT</span></span></code></pre></div><h4 id="find-critical-security-events" tabindex="-1">Find critical security events <a class="header-anchor" href="#find-critical-security-events" aria-label="Permalink to &quot;Find critical security events&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CRITICAL&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUDIT</span></span></code></pre></div><h4 id="list-all-password-changes" tabindex="-1">List all password changes <a class="header-anchor" href="#list-all-password-changes" aria-label="Permalink to &quot;List all password changes&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.password.change&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="find-proxy-lifecycle-events" tabindex="-1">Find proxy lifecycle events <a class="header-anchor" href="#find-proxy-lifecycle-events" aria-label="Permalink to &quot;Find proxy lifecycle events&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;(proxy.started|proxy.stopped|proxy.restarted)&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="export-audit-logs-to-json" tabindex="-1">Export audit logs to JSON <a class="header-anchor" href="#export-audit-logs-to-json" aria-label="Permalink to &quot;Export audit logs to JSON&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT_JSON&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.&#39;</span></span></code></pre></div><h3 id="monitoring-patterns" tabindex="-1">Monitoring Patterns <a class="header-anchor" href="#monitoring-patterns" aria-label="Permalink to &quot;Monitoring Patterns&quot;">​</a></h3><h4 id="failed-login-detection" tabindex="-1">Failed Login Detection <a class="header-anchor" href="#failed-login-detection" aria-label="Permalink to &quot;Failed Login Detection&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Alert on 5+ failed logins from same IP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.login.failed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $NF}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;$1 &gt;= 5&#39;</span></span></code></pre></div><h4 id="privilege-escalation-detection" tabindex="-1">Privilege Escalation Detection <a class="header-anchor" href="#privilege-escalation-detection" aria-label="Permalink to &quot;Privilege Escalation Detection&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Monitor role changes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user.role.changed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="after-hours-activity" tabindex="-1">After-Hours Activity <a class="header-anchor" href="#after-hours-activity" aria-label="Permalink to &quot;After-Hours Activity&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Find activity outside business hours (assuming UTC)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{if ($2 &lt; &quot;08:00:00&quot; || $2 &gt; &quot;18:00:00&quot;) print}&#39;</span></span></code></pre></div><h2 id="audit-logging-integration" tabindex="-1">Audit Logging Integration <a class="header-anchor" href="#audit-logging-integration" aria-label="Permalink to &quot;Audit Logging Integration&quot;">​</a></h2><h3 id="siem-integration" tabindex="-1">SIEM Integration <a class="header-anchor" href="#siem-integration" aria-label="Permalink to &quot;SIEM Integration&quot;">​</a></h3><p>Audit logs are designed for easy integration with Security Information and Event Management (SIEM) systems:</p><p><strong>Supported Integration Methods:</strong></p><ul><li><strong>Splunk</strong> - HTTP Event Collector (HEC)</li><li><strong>Elastic Stack</strong> - Filebeat/Logstash pipeline</li><li><strong>AWS CloudWatch</strong> - Log streaming</li><li><strong>Azure Monitor</strong> - Log Analytics workspace</li><li><strong>QRadar</strong> - Syslog/REST API</li></ul><p><strong>Setup:</strong> Configure external log storage in <strong>Settings → Integrations</strong> section of the web UI.</p><h3 id="webhook-notifications" tabindex="-1">Webhook Notifications <a class="header-anchor" href="#webhook-notifications" aria-label="Permalink to &quot;Webhook Notifications&quot;">​</a></h3><p>Configure real-time webhooks for critical security events:</p><ol><li>Navigate to <strong>Settings → Integrations → Webhooks</strong></li><li>Add webhook URL (Slack, Teams, custom endpoint)</li><li>Select event types to trigger notifications: <ul><li>Failed login attempts</li><li>Access denied events</li><li>Privilege escalation</li><li>Configuration changes</li></ul></li><li>Choose severity levels (info, warning, critical)</li></ol><h3 id="audit-log-aggregation" tabindex="-1">Audit Log Aggregation <a class="header-anchor" href="#audit-log-aggregation" aria-label="Permalink to &quot;Audit Log Aggregation&quot;">​</a></h3><p>For centralized log management, audit logs can be forwarded to:</p><p><strong>Elastic Stack (ELK)</strong></p><ul><li>Use Filebeat to collect and forward logs</li><li>Filter by <code>log_type: audit</code> for audit-specific events</li><li>Configure multiline patterns for structured parsing</li></ul><p><strong>Splunk</strong></p><ul><li>Create a dedicated audit log index</li><li>Use sourcetype for audit events</li><li>Set up dashboards for compliance reporting</li></ul><p><strong>Configuration:</strong> Set up log forwarding in <strong>Settings → Integrations</strong> in the web UI.</p><h2 id="compliance-use-cases" tabindex="-1">Compliance Use Cases <a class="header-anchor" href="#compliance-use-cases" aria-label="Permalink to &quot;Compliance Use Cases&quot;">​</a></h2><h3 id="soc-2-type-ii" tabindex="-1">SOC 2 Type II <a class="header-anchor" href="#soc-2-type-ii" aria-label="Permalink to &quot;SOC 2 Type II&quot;">​</a></h3><ul><li>✅ Administrative access logging (auth.login, auth.logout)</li><li>✅ Configuration change tracking (proxy.<em>, policy.</em>, user.*)</li><li>✅ Access control logging (security.access.denied)</li><li>✅ Audit log integrity (structured format, timestamps)</li></ul><h3 id="audit-system-hipaa" tabindex="-1">Audit System HIPAA <a class="header-anchor" href="#audit-system-hipaa" aria-label="Permalink to &quot;Audit System HIPAA&quot;">​</a></h3><ul><li>✅ User access logging (auth.*)</li><li>✅ PHI access tracking (via proxy audit logs)</li><li>✅ Administrative actions (user.<em>, policy.</em>)</li><li>✅ Security incident logging (security.*)</li></ul><h3 id="audit-system-gdpr" tabindex="-1">Audit System GDPR <a class="header-anchor" href="#audit-system-gdpr" aria-label="Permalink to &quot;Audit System GDPR&quot;">​</a></h3><ul><li>✅ Data access logging (user.<em>, apikey.</em>)</li><li>✅ Data modification tracking (user.updated, user.deleted)</li><li>✅ Consent management (oauth.*)</li><li>✅ Right to be forgotten (user.deleted audit trail)</li></ul><h3 id="audit-system-pci-dss" tabindex="-1">Audit System PCI DSS <a class="header-anchor" href="#audit-system-pci-dss" aria-label="Permalink to &quot;Audit System PCI DSS&quot;">​</a></h3><ul><li>✅ User identification and authentication (auth.*)</li><li>✅ Access control measures (security.access.denied)</li><li>✅ Audit trail for all access to cardholder data</li><li>✅ Security policy enforcement (policy.*)</li></ul><h2 id="audit-logging-implementation-best-practices" tabindex="-1">Audit Logging Implementation Best Practices <a class="header-anchor" href="#audit-logging-implementation-best-practices" aria-label="Permalink to &quot;Audit Logging Implementation Best Practices&quot;">​</a></h2><h3 id="_1-log-retention" tabindex="-1">1. Log Retention <a class="header-anchor" href="#_1-log-retention" aria-label="Permalink to &quot;1. Log Retention&quot;">​</a></h3><p>The AI Security Gateway supports granular retention policies for different data types, allowing you to configure retention periods independently for alerts, audit logs, request logs, token usage, and more.</p><h4 id="configuring-retention-policies" tabindex="-1">Configuring Retention Policies <a class="header-anchor" href="#configuring-retention-policies" aria-label="Permalink to &quot;Configuring Retention Policies&quot;">​</a></h4><p>Configure retention via the <strong>web UI</strong>:</p><ol><li>Navigate to <strong>Settings → Database → Advanced Retention Settings</strong></li><li>Set retention periods for each data type: <ul><li><strong>Security Alerts</strong>: 180 days (recommended)</li><li><strong>Audit Logs</strong>: 90 days (compliance standard)</li><li><strong>Request Logs</strong>: 30 days (privacy-focused)</li><li><strong>Token Usage</strong>: 365 days (annual cost tracking)</li><li><strong>Health Metrics</strong>: 30 days (operational monitoring)</li><li><strong>MCP Tool Logs</strong>: 90 days (same as audit logs)</li><li><strong>LLM Request Logs</strong>: 90 days (same as audit logs)</li><li><strong>A2A Invocation Logs</strong>: 90 days (same as audit logs)</li></ul></li><li>Click <strong>Save</strong> to apply changes</li></ol><h4 id="recommended-retention-periods" tabindex="-1">Recommended Retention Periods <a class="header-anchor" href="#recommended-retention-periods" aria-label="Permalink to &quot;Recommended Retention Periods&quot;">​</a></h4><ul><li><strong>Security Alerts</strong>: 90-180 days (compliance/forensics)</li><li><strong>Audit Logs</strong>: 90 days (compliance requirements)</li><li><strong>Request Logs</strong>: 30 days (privacy - shorter retention)</li><li><strong>Token Usage</strong>: 365 days (annual cost analysis)</li><li><strong>Health Metrics</strong>: 30 days (operational monitoring)</li><li><strong>MCP/LLM/A2A Logs</strong>: 90 days (same as audit logs)</li></ul><h4 id="automatic-cleanup" tabindex="-1">Automatic Cleanup <a class="header-anchor" href="#automatic-cleanup" aria-label="Permalink to &quot;Automatic Cleanup&quot;">​</a></h4><ul><li>Cleanup runs daily at midnight</li><li>Old records are automatically deleted based on retention policy</li><li>Token usage records are now automatically cleaned up (previously missing)</li><li>Changes to retention settings take effect on the next cleanup cycle</li></ul><h3 id="_2-log-analysis" tabindex="-1">2. Log Analysis <a class="header-anchor" href="#_2-log-analysis" aria-label="Permalink to &quot;2. Log Analysis&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Daily security review</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./scripts/audit-report.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y-%m-%d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--critical</span></span></code></pre></div><h3 id="_3-alert-configuration" tabindex="-1">3. Alert Configuration <a class="header-anchor" href="#_3-alert-configuration" aria-label="Permalink to &quot;3. Alert Configuration&quot;">​</a></h3><ul><li>Set up alerts for critical events (security.access.denied)</li><li>Monitor failed login patterns (auth.login.failed)</li><li>Track privilege escalation (user.role.changed)</li></ul><h3 id="_4-regular-audits" tabindex="-1">4. Regular Audits <a class="header-anchor" href="#_4-regular-audits" aria-label="Permalink to &quot;4. Regular Audits&quot;">​</a></h3><ul><li>Weekly: Review critical events</li><li>Monthly: Analyze user activity patterns</li><li>Quarterly: Compliance audit reports</li></ul><h3 id="_5-incident-response" tabindex="-1">5. Incident Response <a class="header-anchor" href="#_5-incident-response" aria-label="Permalink to &quot;5. Incident Response&quot;">​</a></h3><ol><li>Filter logs by time range and user</li><li>Export audit trail to JSON</li><li>Analyze event sequence</li><li>Generate incident report</li></ol><h2 id="audit-logging-performance-considerations" tabindex="-1">Audit Logging Performance Considerations <a class="header-anchor" href="#audit-logging-performance-considerations" aria-label="Permalink to &quot;Audit Logging Performance Considerations&quot;">​</a></h2><ul><li><strong>Minimal Overhead</strong>: Async logging prevents blocking</li><li><strong>Structured Format</strong>: Efficient parsing for analysis</li><li><strong>Log Levels</strong>: Filter by severity in production</li><li><strong>Retention</strong>: Implement log rotation and archival</li></ul><h2 id="audit-logging-implementation-troubleshooting" tabindex="-1">Audit Logging Implementation Troubleshooting <a class="header-anchor" href="#audit-logging-implementation-troubleshooting" aria-label="Permalink to &quot;Audit Logging Implementation Troubleshooting&quot;">​</a></h2><h3 id="missing-audit-logs" tabindex="-1">Missing Audit Logs <a class="header-anchor" href="#missing-audit-logs" aria-label="Permalink to &quot;Missing Audit Logs&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check log file permissions</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -la</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verify audit service is initialized</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Audit service created&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h3 id="high-log-volume" tabindex="-1">High Log Volume <a class="header-anchor" href="#high-log-volume" aria-label="Permalink to &quot;High Log Volume&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check log size</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Filter by severity</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CRITICAL\\|WARN&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h3 id="parsing-errors" tabindex="-1">Parsing Errors <a class="header-anchor" href="#parsing-errors" aria-label="Permalink to &quot;Parsing Errors&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validate JSON format</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT_JSON&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span></span></code></pre></div><h2 id="audit-logging-future-enhancements" tabindex="-1">Audit Logging Future Enhancements <a class="header-anchor" href="#audit-logging-future-enhancements" aria-label="Permalink to &quot;Audit Logging Future Enhancements&quot;">​</a></h2><ol><li><strong>Database Audit Trail</strong> - Store audit events in database for querying</li><li><strong>Real-time Dashboards</strong> - Vue.js audit log viewer</li><li><strong>Advanced Alerting</strong> - Machine learning for anomaly detection</li><li><strong>Compliance Reports</strong> - Automated report generation</li><li><strong>External Integrations</strong> - Direct SIEM/SOAR connectors</li></ol><h2 id="related-documentation" tabindex="-1">Related Documentation <a class="header-anchor" href="#related-documentation" aria-label="Permalink to &quot;Related Documentation&quot;">​</a></h2><ul><li><strong>Settings Configuration</strong>: See <a href="./../configuration/system-settings-guide.html">System Settings Guide</a></li><li><strong>SIEM Integration</strong>: See <a href="./../configuration/integration-setup.html">Integration Setup Guide</a></li><li><strong>Compliance</strong>: See <a href="./../compliance/compliance-overview.html">Compliance Overview</a></li><li><strong>External Reference</strong>: <a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html" target="_blank" rel="noreferrer">OWASP Logging Cheat Sheet</a></li></ul>`,119)])])}const k=i(o,[["render",l]]);export{u as __pageData,k as default};
