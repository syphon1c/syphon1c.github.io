import{_ as t,o as i,c as o,ah as n}from"./chunks/framework.504LQ1l3.js";const a="/assets/mcp-tool-change-results-01.D_D_AeQi.png",s="/assets/mcp-tool-change-alerts-01.D4DcAttz.png",r="/assets/mcp-tool-change-results-02.nnh_upwK.png",l="/assets/mcp-monitoring-settings-01.DhkxCH-E.png",v=JSON.parse('{"title":"MCP Tool Change Monitor","description":"","frontmatter":{},"headers":[],"relativePath":"features/mcp-tool-change.md","filePath":"features/mcp-tool-change.md"}'),g={name:"features/mcp-tool-change.md"};function c(d,e,u,h,p,m){return i(),o("div",null,[...e[0]||(e[0]=[n('<h1 id="mcp-tool-change-monitor" tabindex="-1">MCP Tool Change Monitor <a class="header-anchor" href="#mcp-tool-change-monitor" aria-label="Permalink to &quot;MCP Tool Change Monitor&quot;">​</a></h1><p>The AI Security Gateway includes advanced tool change detection capabilities to monitor and identify modifications in MCP server tool definitions. This feature provides protection against &quot;rug pull&quot; attacks where malicious actors alter MCP tool behavior after gaining user trust.</p><p><img src="'+a+'" alt="Tool Change Detection"></p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The MCP Tool Change Monitor provides:</p><ul><li><strong>Baseline Protection</strong>: Automatic baseline creation when MCP proxies are first configured</li><li><strong>Real-time Detection</strong>: Continuous monitoring of tool definitions and functionality changes</li><li><strong>Manual Verification</strong>: On-demand change detection for immediate security assessment</li><li><strong>Automatic Alerts</strong>: Background monitoring with alert generation for detected changes</li><li><strong>Historical Tracking</strong>: Track tool evolution and identify suspicious modification patterns</li><li><strong>Rug Pull Defense</strong>: Early detection of malicious tool behavior changes</li></ul><p><img src="'+s+'" alt="Tool Change Alerts"></p><h2 id="understanding-rug-pull-attacks" tabindex="-1">Understanding Rug Pull Attacks <a class="header-anchor" href="#understanding-rug-pull-attacks" aria-label="Permalink to &quot;Understanding Rug Pull Attacks&quot;">​</a></h2><p><strong>What is a Rug Pull Attack?</strong> A rug pull attack occurs when:</p><ol><li>An MCP server initially presents legitimate, safe tools</li><li>Users begin trusting and using the server</li><li>The server maliciously modifies tool behavior to perform harmful actions</li><li>Users unknowingly execute the modified, malicious tools</li></ol><p><strong>Protection Strategy:</strong> The Tool Change Monitor creates a secure baseline of all tool definitions and continuously compares current tools against this baseline to detect unauthorized modifications.</p><h2 id="accessing-the-tool-change-monitor" tabindex="-1">Accessing the Tool Change Monitor <a class="header-anchor" href="#accessing-the-tool-change-monitor" aria-label="Permalink to &quot;Accessing the Tool Change Monitor&quot;">​</a></h2><p>To access the MCP Tool Change Monitor:</p><ol><li>Navigate to <strong>Security</strong> in the main menu</li><li>Select <strong>MCP Security</strong> from the dropdown</li><li>Click on the <strong>&quot;Tool Change Monitor&quot;</strong> tab</li></ol><h2 id="baseline-creation" tabindex="-1">Baseline Creation <a class="header-anchor" href="#baseline-creation" aria-label="Permalink to &quot;Baseline Creation&quot;">​</a></h2><h3 id="automatic-baseline" tabindex="-1">Automatic Baseline <a class="header-anchor" href="#automatic-baseline" aria-label="Permalink to &quot;Automatic Baseline&quot;">​</a></h3><p>When an MCP server proxy is first configured in the AI Security Gateway:</p><p><strong>Automatic Process:</strong></p><ul><li><strong>Tool Discovery</strong>: Complete enumeration of available tools</li><li><strong>Definition Capture</strong>: Detailed recording of tool schemas, parameters, and descriptions</li><li><strong>Functionality Mapping</strong>: Documentation of expected tool behavior patterns</li><li><strong>Signature Creation</strong>: Cryptographic signatures for tool integrity verification</li><li><strong>Baseline Storage</strong>: Secure storage of baseline data for future comparison</li></ul><p><strong>Baseline Components:</strong></p><ul><li>Tool names and descriptions</li><li>Input parameter schemas</li><li>Output format definitions</li><li>Permission requirements</li><li>Resource access patterns</li></ul><h2 id="manual-change-detection" tabindex="-1">Manual Change Detection <a class="header-anchor" href="#manual-change-detection" aria-label="Permalink to &quot;Manual Change Detection&quot;">​</a></h2><h3 id="step-1-select-target-mcp-server" tabindex="-1">Step 1: Select Target MCP Server <a class="header-anchor" href="#step-1-select-target-mcp-server" aria-label="Permalink to &quot;Step 1: Select Target MCP Server&quot;">​</a></h3><p>The monitor interface provides a dropdown list of all configured MCP servers in your AI Security Gateway deployment.</p><p><strong>Available Options:</strong></p><ul><li>All currently configured MCP proxy instances</li><li>Server status indicators (online/offline)</li><li>Last change detection timestamp (if previously scanned)</li><li>Baseline creation date and version</li></ul><h3 id="step-2-review-previous-detection-results-optional" tabindex="-1">Step 2: Review Previous Detection Results (Optional) <a class="header-anchor" href="#step-2-review-previous-detection-results-optional" aria-label="Permalink to &quot;Step 2: Review Previous Detection Results (Optional)&quot;">​</a></h3><p>When you select an MCP server from the dropdown:</p><ul><li><strong>Previous detection results</strong> are automatically displayed (if available)</li><li><strong>Last scan timestamp</strong> shows when the last change detection was performed</li><li><strong>Change summary</strong> provides overview of any modifications found</li><li><strong>Baseline comparison</strong> shows current vs. original tool definitions</li></ul><h3 id="step-3-detect-changes" tabindex="-1">Step 3: Detect Changes <a class="header-anchor" href="#step-3-detect-changes" aria-label="Permalink to &quot;Step 3: Detect Changes&quot;">​</a></h3><p>Click the <strong>&quot;Detect Changes&quot;</strong> button to initiate a new change detection scan:</p><ul><li><strong>Real-time Analysis</strong>: Live comparison against established baseline</li><li><strong>Comprehensive Checking</strong>: Verification of all tool definitions and parameters</li><li><strong>Immediate Results</strong>: Instant notification of any detected changes</li><li><strong>Alert Generation</strong>: Automatic alert creation for significant modifications</li></ul><h2 id="change-detection-results" tabindex="-1">Change Detection Results <a class="header-anchor" href="#change-detection-results" aria-label="Permalink to &quot;Change Detection Results&quot;">​</a></h2><p>The monitor provides detailed analysis of any detected modifications:</p><p><img src="'+r+'" alt="Tool Change Detection Difference"></p><h3 id="detection-results-include" tabindex="-1">Detection Results Include: <a class="header-anchor" href="#detection-results-include" aria-label="Permalink to &quot;Detection Results Include:&quot;">​</a></h3><p><strong>Change Categories:</strong></p><ul><li><strong>New Tools</strong>: Tools added since baseline creation</li><li><strong>Removed Tools</strong>: Tools that are no longer available</li><li><strong>Modified Definitions</strong>: Changes to existing tool schemas or descriptions</li><li><strong>Parameter Changes</strong>: Modifications to input/output parameters</li><li><strong>Permission Changes</strong>: Alterations to required permissions or access levels</li><li><strong>Behavioral Changes</strong>: Detected differences in tool execution patterns</li></ul><p><strong>Change Details:</strong></p><ul><li><strong>Severity Assessment</strong>: Critical, High, Medium, Low risk rating</li><li><strong>Modification Type</strong>: Addition, removal, or alteration</li><li><strong>Comparison View</strong>: Before/after comparison of tool definitions</li><li><strong>Risk Analysis</strong>: Potential security implications of detected changes</li><li><strong>Recommendation</strong>: Suggested actions for addressing the changes</li></ul><p><strong>Detection Metadata:</strong></p><ul><li><strong>Scan Duration</strong>: Time taken to complete the change detection</li><li><strong>Baseline Version</strong>: Version of baseline used for comparison</li><li><strong>Detection Timestamp</strong>: When the change detection was performed</li><li><strong>Change Count</strong>: Total number of modifications identified</li></ul><h2 id="background-monitoring" tabindex="-1">Background Monitoring <a class="header-anchor" href="#background-monitoring" aria-label="Permalink to &quot;Background Monitoring&quot;">​</a></h2><h3 id="automatic-change-detection" tabindex="-1">Automatic Change Detection <a class="header-anchor" href="#automatic-change-detection" aria-label="Permalink to &quot;Automatic Change Detection&quot;">​</a></h3><p>The AI Security Gateway includes a background monitoring service that:</p><p><strong>Continuous Monitoring:</strong></p><ul><li><strong>Regular Scans</strong>: Periodic tool change detection during normal operation</li><li><strong>Real-time Alerts</strong>: Immediate notification when changes are detected</li><li><strong>Trend Analysis</strong>: Identification of patterns in tool modifications</li><li><strong>Risk Escalation</strong>: Automatic severity assessment and alert prioritization</li></ul><p><strong>Integration with Security Operations:</strong></p><ul><li><strong>Alert System</strong>: Changes trigger security alerts in the main dashboard</li><li><strong>Audit Logging</strong>: All detected changes are logged for compliance and investigation</li><li><strong>Policy Enforcement</strong>: Automatic blocking of proxies with suspicious changes (configurable)</li><li><strong>Notification Systems</strong>: Integration with SIEM, SOAR, and messaging platforms</li></ul><h2 id="configuration-settings" tabindex="-1">Configuration Settings <a class="header-anchor" href="#configuration-settings" aria-label="Permalink to &quot;Configuration Settings&quot;">​</a></h2><h3 id="mcp-monitoring-settings" tabindex="-1">MCP Monitoring Settings <a class="header-anchor" href="#mcp-monitoring-settings" aria-label="Permalink to &quot;MCP Monitoring Settings&quot;">​</a></h3><p>Configure automatic tool change monitoring under <strong>Settings → MCP Monitoring</strong>:</p><p><img src="'+l+'" alt="MCP Monitoring Settings"></p><p><strong>Available Configuration Options:</strong></p><p><strong>Enable/Disable Monitoring:</strong></p><ul><li><strong>Automatic Monitoring</strong>: Toggle background change detection on/off</li><li><strong>Per-Proxy Control</strong>: Enable monitoring for specific MCP servers only</li><li><strong>Alert Generation</strong>: Control whether changes trigger security alerts</li><li><strong>Audit Logging</strong>: Configure logging level for change detection events</li></ul><p><strong>Scan Intervals:</strong></p><ul><li><strong>Rapid Monitoring</strong>: Every 5 minutes (high-security environments)</li><li><strong>Standard Monitoring</strong>: Every 30 minutes (recommended default)</li><li><strong>Periodic Monitoring</strong>: Every 2 hours (low-risk environments)</li><li><strong>Custom Intervals</strong>: User-defined monitoring frequency</li></ul><p><strong>Alert Thresholds:</strong></p><ul><li><strong>Critical Changes</strong>: Tool removal or major permission escalation</li><li><strong>Significant Changes</strong>: New tools or modified tool behavior</li><li><strong>Minor Changes</strong>: Description updates or cosmetic modifications</li><li><strong>Noise Reduction</strong>: Filter out benign changes to reduce alert fatigue</li></ul><p><strong>Response Actions:</strong></p><ul><li><strong>Alert Only</strong>: Generate alerts but continue allowing proxy traffic</li><li><strong>Quarantine</strong>: Temporarily disable proxy while investigating changes</li><li><strong>Block</strong>: Permanently disable proxy until manual review and approval</li><li><strong>Notify</strong>: Send notifications to security team without disrupting service</li></ul><h2 id="understanding-change-severity" tabindex="-1">Understanding Change Severity <a class="header-anchor" href="#understanding-change-severity" aria-label="Permalink to &quot;Understanding Change Severity&quot;">​</a></h2><h3 id="severity-levels" tabindex="-1">Severity Levels <a class="header-anchor" href="#severity-levels" aria-label="Permalink to &quot;Severity Levels&quot;">​</a></h3><p><strong>Critical (Immediate Action Required)</strong></p><ul><li>Tool removal that eliminates safety features</li><li>Permission escalation to system-level access</li><li>Introduction of tools with dangerous capabilities</li><li>Modification of authentication or authorization mechanisms</li></ul><p><strong>High (Urgent Investigation)</strong></p><ul><li>Addition of new tools with broad system access</li><li>Significant changes to existing tool functionality</li><li>Modifications to security-related parameters</li><li>Changes that could facilitate data exfiltration</li></ul><p><strong>Medium (Review Required)</strong></p><ul><li>Addition of new tools with limited scope</li><li>Minor modifications to existing tool behavior</li><li>Changes to tool descriptions or metadata</li><li>Alterations that don&#39;t directly impact security</li></ul><p><strong>Low (Informational)</strong></p><ul><li>Cosmetic changes to tool descriptions</li><li>Version updates with no functional changes</li><li>Documentation improvements</li><li>Benign parameter additions or modifications</li></ul><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="monitoring-strategy" tabindex="-1">Monitoring Strategy <a class="header-anchor" href="#monitoring-strategy" aria-label="Permalink to &quot;Monitoring Strategy&quot;">​</a></h3><p><strong>Baseline Management:</strong></p><ul><li><strong>Regular Updates</strong>: Update baselines for legitimate tool evolution</li><li><strong>Version Control</strong>: Maintain historical baselines for forensic analysis</li><li><strong>Validation</strong>: Verify baseline integrity after updates</li><li><strong>Documentation</strong>: Record approved changes and their business justification</li></ul><p><strong>Alert Management:</strong></p><ul><li><strong>Rapid Response</strong>: Investigate critical and high-severity changes immediately</li><li><strong>Trend Analysis</strong>: Look for patterns in tool modifications across servers</li><li><strong>False Positive Reduction</strong>: Fine-tune alerting thresholds based on environment</li><li><strong>Escalation Procedures</strong>: Define clear escalation paths for different change types</li></ul><h3 id="security-operations-integration" tabindex="-1">Security Operations Integration <a class="header-anchor" href="#security-operations-integration" aria-label="Permalink to &quot;Security Operations Integration&quot;">​</a></h3><p><strong>Incident Response:</strong></p><ol><li><strong>Immediate Assessment</strong>: Evaluate the nature and scope of detected changes</li><li><strong>Risk Analysis</strong>: Determine potential security implications</li><li><strong>Containment</strong>: Isolate affected proxies if necessary</li><li><strong>Investigation</strong>: Analyze the root cause of tool modifications</li><li><strong>Resolution</strong>: Apply appropriate remediation or approve legitimate changes</li></ol><p><strong>Compliance and Governance:</strong></p><ul><li><strong>Change Documentation</strong>: Maintain records of all tool modifications</li><li><strong>Approval Workflows</strong>: Implement formal approval processes for tool changes</li><li><strong>Risk Assessment</strong>: Regular evaluation of tool change patterns and trends</li><li><strong>Policy Updates</strong>: Adjust monitoring policies based on operational experience</li></ul><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="common-issues" tabindex="-1">Common Issues <a class="header-anchor" href="#common-issues" aria-label="Permalink to &quot;Common Issues&quot;">​</a></h3><p><strong>False Positive Alerts:</strong></p><ul><li>✅ Review change details to distinguish legitimate from suspicious modifications</li><li>✅ Adjust alert thresholds to reduce noise from benign changes</li><li>✅ Update baselines after confirming legitimate tool evolution</li><li>✅ Implement change approval workflows for known modifications</li></ul><p><strong>Missed Changes:</strong></p><ul><li>✅ Verify monitoring is enabled for all relevant MCP servers</li><li>✅ Check scan intervals are appropriate for your security requirements</li><li>✅ Ensure network connectivity between gateway and MCP servers</li><li>✅ Review baseline integrity and update if corrupted</li></ul><p><strong>Performance Impact:</strong></p><ul><li>✅ Optimize scan intervals based on server capacity and security needs</li><li>✅ Consider disabling monitoring for low-risk, internal MCP servers</li><li>✅ Implement monitoring schedules during low-traffic periods</li><li>✅ Use selective monitoring for specific tool categories only</li></ul><h3 id="monitoring-limitations" tabindex="-1">Monitoring Limitations <a class="header-anchor" href="#monitoring-limitations" aria-label="Permalink to &quot;Monitoring Limitations&quot;">​</a></h3><p><strong>Important Considerations:</strong></p><ul><li><strong>Baseline Dependency</strong>: Detection accuracy depends on comprehensive initial baselines</li><li><strong>Network Accessibility</strong>: Requires consistent connectivity to monitored MCP servers</li><li><strong>Legitimate Changes</strong>: May generate alerts for authorized tool updates</li><li><strong>Behavioral Analysis</strong>: Cannot detect malicious behavior that doesn&#39;t change tool definitions</li></ul>',94)])])}const y=t(g,[["render",c]]);export{v as __pageData,y as default};
