<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Comprehensive Audit Logging | AI Security Gateway</title>
    <meta name="description" content="Security Platform for MCP Servers and LLM APIs - User Guide">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.qp7qGaqN.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.jfFr6F2g.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.504LQ1l3.js">
    <link rel="modulepreload" href="/assets/chunks/theme.DTFkiJA1.js">
    <link rel="modulepreload" href="/assets/chunks/katex.CBSAILhF.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-c83219d4.DBJWlqw-.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-50d868cf.CnphSO9X.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-4f6560a1.g8tiZSxd.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-0228fc6a.lx2gI2Ax.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-82fe8481.BuiOG0fy.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-a2739b55.DvzKo7xt.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-8eee0895.C8MtC4RG.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-a8764435._xhhyCzl.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-1e28029f.DxTdgPnt.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-f5964ef8.RAumNX0J.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-08caed73.D_JmwWfw.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-c5b8d532.KLeQ7C25.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-beda092f.B6VQrwZO.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-2358418a.DSkob29S.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-1ecb1508.BRQfLQcR.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-c2b004d7.BQa0W455.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-c64418c1.8V1vCl_c.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-6af322e1.CYRiLBDs.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-faaaa080.CnYR7nm3.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-8da855dc.Bv8dO8LF.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-a04cb91d.KP0w6_Yt.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-c4efeb88.CINjRaBI.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/operations_audit-logging.md.DtoZSt6u.lean.js">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>AI Security Gateway</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/getting-started/installation.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/configuration/authentication.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Configuration</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/operations/observability-user-guide.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Operations</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/syphon1c/ai-security-gateway" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/syphon1c/ai-security-gateway" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Getting Started</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/installation.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/admin-quick-start-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Admin Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/configuration.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/user-architecture-overview.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Architecture Overview</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Changelog</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/changelog-2026.2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Current 2026.2</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Configuration</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/authentication.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Authentication</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/api-key-authentication.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API Key Authentication</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/custom-api-keys.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Custom API Keys</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/environment-variables.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Environment Variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/policy-overview-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Security Policies</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/custom-policies-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Custom Policies</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/system-prompts-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>System Prompts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/oauth-provider-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Provider Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/oauth-proxy-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Proxy Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/xaa-cross-app-access.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>XAA Cross App Access</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Deployment</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/docker-commands.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Docker Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/docker-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Docker Deployment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/web-server-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Web Server Deployment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/hybrid-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Hybrid Deployment</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Integration</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/integration-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Integration Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/claude-code-proxy-setup.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Claude Code Proxy Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/cursor-mcp-oauth-setup.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Cursor MCP OAuth</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/oauth-proxy-chatbot-integration-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Chatbot Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/oauth-proxy-quick-reference.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Quick Reference</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/langfuse-setup-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Langfuse Setup</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Operations</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/observability-user-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Observability Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/alert-recording-system.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Alert Recording</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/audit-logging.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Audit Logging</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/user-activity-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>User Activity Tracking Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/security-runbook.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Security Runbook</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/threat-model.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Threat Model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/budget-management-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Budget Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/troubleshooting.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Troubleshooting</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Features</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/features/data-masking-redaction.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Data Masking</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/features/mcp-vulnerability-scanner.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>MCP Vulnerability Scanner</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/features/mcp-tool-change.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>MCP Vool Change Detection</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>API Usage</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/api-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/proxy-api.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Proxy API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/oauth-api-reference.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth API Reference</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/a2a-api.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>A2A API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>A2A</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/a2a/agent-registry-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Agent Registry Guide</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _operations_audit-logging" data-v-e6f2a212><div><h1 id="comprehensive-audit-logging" tabindex="-1">Comprehensive Audit Logging <a class="header-anchor" href="#comprehensive-audit-logging" aria-label="Permalink to &quot;Comprehensive Audit Logging&quot;">​</a></h1><p>The AI Security Gateway includes enterprise-grade audit logging that tracks all security-sensitive operations for compliance, security monitoring, and incident response.</p><p><img src="/assets/audit-system-log-viewer-02.C0HutivL.png" alt="Audit Log Viewer"></p><h2 id="audit-logging-overview" tabindex="-1">Audit Logging Overview <a class="header-anchor" href="#audit-logging-overview" aria-label="Permalink to &quot;Audit Logging Overview&quot;">​</a></h2><p>The audit logging system provides:</p><ul><li><strong>35+ event types</strong> covering authentication, user management, resource operations, and security events</li><li><strong>Structured JSON output</strong> for integration with SIEM/SOAR systems</li><li><strong>Complete attribution</strong> with user ID, username, email, role, IP address, and user agent</li><li><strong>Severity levels</strong> (info, warning, critical) for prioritization</li><li><strong>Compliance ready</strong> for SOC 2, HIPAA, GDPR, and PCI DSS requirements</li></ul><h2 id="how-audit-logging-works" tabindex="-1">How Audit Logging Works <a class="header-anchor" href="#how-audit-logging-works" aria-label="Permalink to &quot;How Audit Logging Works&quot;">​</a></h2><h3 id="core-capabilities" tabindex="-1">Core Capabilities <a class="header-anchor" href="#core-capabilities" aria-label="Permalink to &quot;Core Capabilities&quot;">​</a></h3><ul><li><strong>Automatic Tracking</strong> - All security-sensitive operations are automatically logged</li><li><strong>Dual Output</strong> - Logs available in both human-readable and JSON formats</li><li><strong>Structured Data</strong> - Every event includes timestamp, user details, action, result, and context</li><li><strong>Integration Ready</strong> - JSON format designed for SIEM/SOAR system integration</li></ul><h3 id="what-gets-logged" tabindex="-1">What Gets Logged <a class="header-anchor" href="#what-gets-logged" aria-label="Permalink to &quot;What Gets Logged&quot;">​</a></h3><p>Every audit event captures:</p><ul><li><strong>Who</strong>: User ID, username, email, role</li><li><strong>What</strong>: Action performed and resource affected</li><li><strong>When</strong>: Precise timestamp (UTC)</li><li><strong>Where</strong>: Source IP address and user agent</li><li><strong>Result</strong>: Success, failure, or partial completion</li><li><strong>Why</strong>: Context and additional details</li><li><strong>Severity</strong>: Info, warning, or critical priority</li></ul><h2 id="event-types" tabindex="-1">Event Types <a class="header-anchor" href="#event-types" aria-label="Permalink to &quot;Event Types&quot;">​</a></h2><h3 id="authentication-events-6-types" tabindex="-1">Authentication Events (6 types) <a class="header-anchor" href="#authentication-events-6-types" aria-label="Permalink to &quot;Authentication Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>auth.login</code></td><td>Successful user login</td><td>info</td></tr><tr><td><code>auth.login.failed</code></td><td>Failed login attempt</td><td>warning</td></tr><tr><td><code>auth.logout</code></td><td>User logout</td><td>info</td></tr><tr><td><code>auth.token.refresh</code></td><td>JWT token refresh</td><td>info</td></tr><tr><td><code>auth.password.change</code></td><td>User password change</td><td>info</td></tr><tr><td><code>auth.password.reset</code></td><td>Admin password reset</td><td>warning</td></tr></tbody></table><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:23:45 INFO [audit] [AUDIT] [auth.login] admin (ID:1) auth.login - authentication:admin - Result: success | User logged in successfully with role: admin | IP: 192.168.1.100</span></span></code></pre></div><h3 id="user-management-events-6-types" tabindex="-1">User Management Events (6 types) <a class="header-anchor" href="#user-management-events-6-types" aria-label="Permalink to &quot;User Management Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>user.created</code></td><td>New user account created</td><td>info</td></tr><tr><td><code>user.updated</code></td><td>User profile modified</td><td>info</td></tr><tr><td><code>user.deleted</code></td><td>User account deleted</td><td>warning</td></tr><tr><td><code>user.deactivated</code></td><td>User account deactivated</td><td>warning</td></tr><tr><td><code>user.activated</code></td><td>User account reactivated</td><td>info</td></tr><tr><td><code>user.role.changed</code></td><td>User role modified</td><td>warning</td></tr></tbody></table><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:25:30 INFO [audit] [AUDIT] [user.created] admin (ID:1) create user - user:42 (john.doe) - Result: success | Created user &#39;john.doe&#39; with role &#39;user&#39; | IP: 192.168.1.100</span></span></code></pre></div><h3 id="api-key-events-5-types" tabindex="-1">API Key Events (5 types) <a class="header-anchor" href="#api-key-events-5-types" aria-label="Permalink to &quot;API Key Events (5 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>apikey.created</code></td><td>API key generated</td><td>info</td></tr><tr><td><code>apikey.updated</code></td><td>API key modified</td><td>info</td></tr><tr><td><code>apikey.deleted</code></td><td>API key deleted</td><td>warning</td></tr><tr><td><code>apikey.revoked</code></td><td>API key revoked</td><td>warning</td></tr><tr><td><code>apikey.used</code></td><td>API key authenticated</td><td>info</td></tr></tbody></table><h3 id="user-group-events-5-types" tabindex="-1">User Group Events (5 types) <a class="header-anchor" href="#user-group-events-5-types" aria-label="Permalink to &quot;User Group Events (5 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>usergroup.created</code></td><td>User group created</td><td>info</td></tr><tr><td><code>usergroup.updated</code></td><td>User group modified</td><td>info</td></tr><tr><td><code>usergroup.deleted</code></td><td>User group deleted</td><td>warning</td></tr><tr><td><code>usergroup.access.added</code></td><td>Member added to group</td><td>info</td></tr><tr><td><code>usergroup.access.removed</code></td><td>Member removed from group</td><td>info</td></tr></tbody></table><h3 id="proxy-lifecycle-events-6-types" tabindex="-1">Proxy Lifecycle Events (6 types) <a class="header-anchor" href="#proxy-lifecycle-events-6-types" aria-label="Permalink to &quot;Proxy Lifecycle Events (6 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>proxy.created</code></td><td>Proxy configuration created</td><td>info</td></tr><tr><td><code>proxy.updated</code></td><td>Proxy settings modified</td><td>info</td></tr><tr><td><code>proxy.deleted</code></td><td>Proxy configuration removed</td><td>warning</td></tr><tr><td><code>proxy.started</code></td><td>Proxy instance started</td><td>info</td></tr><tr><td><code>proxy.stopped</code></td><td>Proxy instance stopped</td><td>info</td></tr><tr><td><code>proxy.restarted</code></td><td>Proxy instance restarted</td><td>info</td></tr></tbody></table><h3 id="policy-assignment-events-4-types" tabindex="-1">Policy Assignment Events (4 types) <a class="header-anchor" href="#policy-assignment-events-4-types" aria-label="Permalink to &quot;Policy Assignment Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>policy.assigned</code></td><td>Security policy assigned to proxy</td><td>info</td></tr><tr><td><code>policy.unassigned</code></td><td>Security policy removed from proxy</td><td>info</td></tr><tr><td><code>policy.bulk.assigned</code></td><td>Multiple policies assigned</td><td>info</td></tr><tr><td><code>policy.assignment.updated</code></td><td>Policy assignment modified</td><td>info</td></tr></tbody></table><h3 id="mcp-tool-events-4-types" tabindex="-1">MCP Tool Events (4 types) <a class="header-anchor" href="#mcp-tool-events-4-types" aria-label="Permalink to &quot;MCP Tool Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>mcp.tool.enabled</code></td><td>MCP tool enabled</td><td>info</td></tr><tr><td><code>mcp.tool.disabled</code></td><td>MCP tool disabled</td><td>info</td></tr><tr><td><code>mcp.tool.bulk.updated</code></td><td>Multiple tools updated</td><td>info</td></tr><tr><td><code>mcp.tool.discovered</code></td><td>Tools discovered from MCP server</td><td>info</td></tr></tbody></table><h3 id="oauth-provider-events-4-types" tabindex="-1">OAuth Provider Events (4 types) <a class="header-anchor" href="#oauth-provider-events-4-types" aria-label="Permalink to &quot;OAuth Provider Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>oauth.provider.created</code></td><td>OAuth provider configured</td><td>info</td></tr><tr><td><code>oauth.provider.updated</code></td><td>OAuth provider modified</td><td>info</td></tr><tr><td><code>oauth.provider.deleted</code></td><td>OAuth provider removed</td><td>warning</td></tr><tr><td><code>oauth.session.revoked</code></td><td>OAuth session revoked</td><td>warning</td></tr></tbody></table><h3 id="security-events-4-types" tabindex="-1">Security Events (4 types) <a class="header-anchor" href="#security-events-4-types" aria-label="Permalink to &quot;Security Events (4 types)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Event Type</th><th>Description</th><th>Severity</th></tr></thead><tbody><tr><td><code>security.access.denied</code></td><td>Unauthorized access attempt</td><td>critical</td></tr><tr><td><code>security.input.invalid</code></td><td>Invalid input detected</td><td>warning</td></tr><tr><td><code>security.ratelimit.exceeded</code></td><td>Rate limit violation</td><td>warning</td></tr><tr><td><code>security.suspicious.activity</code></td><td>Suspicious behavior detected</td><td>critical</td></tr></tbody></table><h2 id="log-format" tabindex="-1">Log Format <a class="header-anchor" href="#log-format" aria-label="Permalink to &quot;Log Format&quot;">​</a></h2><h3 id="human-readable-format" tabindex="-1">Human-Readable Format <a class="header-anchor" href="#human-readable-format" aria-label="Permalink to &quot;Human-Readable Format&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[TIMESTAMP] [LEVEL] [COMPONENT] [AUDIT] [EVENT_TYPE] ACTOR ACTION - RESOURCE - Result: RESULT | DETAILS | IP: SOURCE_IP</span></span></code></pre></div><p><strong>Example:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-10-28 14:23:45 INFO [AI Security Gateway] [audit] [AUDIT] [auth.login] admin (ID:1) auth.login - authentication:admin - Result: success | User logged in successfully with role: admin | IP: 192.168.1.100</span></span></code></pre></div><h3 id="json-format-siem-integration" tabindex="-1">JSON Format (SIEM Integration) <a class="header-anchor" href="#json-format-siem-integration" aria-label="Permalink to &quot;JSON Format (SIEM Integration)&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth.login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-10-28T14:23:45Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;severity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;actor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin@localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;role&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;authentication&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth.login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;details&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;User logged in successfully with role: admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;metadata&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;source_ip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.1.100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;user_agent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mozilla/5.0...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error_message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="audit-logging-usage-examples" tabindex="-1">Audit Logging Usage Examples <a class="header-anchor" href="#audit-logging-usage-examples" aria-label="Permalink to &quot;Audit Logging Usage Examples&quot;">​</a></h2><h3 id="querying-audit-logs" tabindex="-1">Querying Audit Logs <a class="header-anchor" href="#querying-audit-logs" aria-label="Permalink to &quot;Querying Audit Logs&quot;">​</a></h3><h4 id="find-all-failed-login-attempts" tabindex="-1">Find all failed login attempts <a class="header-anchor" href="#find-all-failed-login-attempts" aria-label="Permalink to &quot;Find all failed login attempts&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.login.failed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="track-actions-by-specific-user" tabindex="-1">Track actions by specific user <a class="header-anchor" href="#track-actions-by-specific-user" aria-label="Permalink to &quot;Track actions by specific user&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;admin (ID:1)&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUDIT</span></span></code></pre></div><h4 id="find-critical-security-events" tabindex="-1">Find critical security events <a class="header-anchor" href="#find-critical-security-events" aria-label="Permalink to &quot;Find critical security events&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CRITICAL&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUDIT</span></span></code></pre></div><h4 id="list-all-password-changes" tabindex="-1">List all password changes <a class="header-anchor" href="#list-all-password-changes" aria-label="Permalink to &quot;List all password changes&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.password.change&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="find-proxy-lifecycle-events" tabindex="-1">Find proxy lifecycle events <a class="header-anchor" href="#find-proxy-lifecycle-events" aria-label="Permalink to &quot;Find proxy lifecycle events&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;(proxy.started|proxy.stopped|proxy.restarted)&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="export-audit-logs-to-json" tabindex="-1">Export audit logs to JSON <a class="header-anchor" href="#export-audit-logs-to-json" aria-label="Permalink to &quot;Export audit logs to JSON&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT_JSON&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.&#39;</span></span></code></pre></div><h3 id="monitoring-patterns" tabindex="-1">Monitoring Patterns <a class="header-anchor" href="#monitoring-patterns" aria-label="Permalink to &quot;Monitoring Patterns&quot;">​</a></h3><h4 id="failed-login-detection" tabindex="-1">Failed Login Detection <a class="header-anchor" href="#failed-login-detection" aria-label="Permalink to &quot;Failed Login Detection&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Alert on 5+ failed logins from same IP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auth.login.failed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $NF}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;$1 &gt;= 5&#39;</span></span></code></pre></div><h4 id="privilege-escalation-detection" tabindex="-1">Privilege Escalation Detection <a class="header-anchor" href="#privilege-escalation-detection" aria-label="Permalink to &quot;Privilege Escalation Detection&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Monitor role changes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user.role.changed&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h4 id="after-hours-activity" tabindex="-1">After-Hours Activity <a class="header-anchor" href="#after-hours-activity" aria-label="Permalink to &quot;After-Hours Activity&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Find activity outside business hours (assuming UTC)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{if ($2 &lt; &quot;08:00:00&quot; || $2 &gt; &quot;18:00:00&quot;) print}&#39;</span></span></code></pre></div><h2 id="audit-logging-integration" tabindex="-1">Audit Logging Integration <a class="header-anchor" href="#audit-logging-integration" aria-label="Permalink to &quot;Audit Logging Integration&quot;">​</a></h2><h3 id="siem-integration" tabindex="-1">SIEM Integration <a class="header-anchor" href="#siem-integration" aria-label="Permalink to &quot;SIEM Integration&quot;">​</a></h3><p>Audit logs are designed for easy integration with Security Information and Event Management (SIEM) systems:</p><p><strong>Supported Integration Methods:</strong></p><ul><li><strong>Splunk</strong> - HTTP Event Collector (HEC)</li><li><strong>Elastic Stack</strong> - Filebeat/Logstash pipeline</li><li><strong>AWS CloudWatch</strong> - Log streaming</li><li><strong>Azure Monitor</strong> - Log Analytics workspace</li><li><strong>QRadar</strong> - Syslog/REST API</li></ul><p><strong>Setup:</strong> Configure external log storage in <strong>Settings → Integrations</strong> section of the web UI.</p><h3 id="webhook-notifications" tabindex="-1">Webhook Notifications <a class="header-anchor" href="#webhook-notifications" aria-label="Permalink to &quot;Webhook Notifications&quot;">​</a></h3><p>Configure real-time webhooks for critical security events:</p><ol><li>Navigate to <strong>Settings → Integrations → Webhooks</strong></li><li>Add webhook URL (Slack, Teams, custom endpoint)</li><li>Select event types to trigger notifications: <ul><li>Failed login attempts</li><li>Access denied events</li><li>Privilege escalation</li><li>Configuration changes</li></ul></li><li>Choose severity levels (info, warning, critical)</li></ol><h3 id="audit-log-aggregation" tabindex="-1">Audit Log Aggregation <a class="header-anchor" href="#audit-log-aggregation" aria-label="Permalink to &quot;Audit Log Aggregation&quot;">​</a></h3><p>For centralized log management, audit logs can be forwarded to:</p><p><strong>Elastic Stack (ELK)</strong></p><ul><li>Use Filebeat to collect and forward logs</li><li>Filter by <code>log_type: audit</code> for audit-specific events</li><li>Configure multiline patterns for structured parsing</li></ul><p><strong>Splunk</strong></p><ul><li>Create a dedicated audit log index</li><li>Use sourcetype for audit events</li><li>Set up dashboards for compliance reporting</li></ul><p><strong>Configuration:</strong> Set up log forwarding in <strong>Settings → Integrations</strong> in the web UI.</p><h2 id="compliance-use-cases" tabindex="-1">Compliance Use Cases <a class="header-anchor" href="#compliance-use-cases" aria-label="Permalink to &quot;Compliance Use Cases&quot;">​</a></h2><h3 id="soc-2-type-ii" tabindex="-1">SOC 2 Type II <a class="header-anchor" href="#soc-2-type-ii" aria-label="Permalink to &quot;SOC 2 Type II&quot;">​</a></h3><ul><li>✅ Administrative access logging (auth.login, auth.logout)</li><li>✅ Configuration change tracking (proxy.<em>, policy.</em>, user.*)</li><li>✅ Access control logging (security.access.denied)</li><li>✅ Audit log integrity (structured format, timestamps)</li></ul><h3 id="audit-system-hipaa" tabindex="-1">Audit System HIPAA <a class="header-anchor" href="#audit-system-hipaa" aria-label="Permalink to &quot;Audit System HIPAA&quot;">​</a></h3><ul><li>✅ User access logging (auth.*)</li><li>✅ PHI access tracking (via proxy audit logs)</li><li>✅ Administrative actions (user.<em>, policy.</em>)</li><li>✅ Security incident logging (security.*)</li></ul><h3 id="audit-system-gdpr" tabindex="-1">Audit System GDPR <a class="header-anchor" href="#audit-system-gdpr" aria-label="Permalink to &quot;Audit System GDPR&quot;">​</a></h3><ul><li>✅ Data access logging (user.<em>, apikey.</em>)</li><li>✅ Data modification tracking (user.updated, user.deleted)</li><li>✅ Consent management (oauth.*)</li><li>✅ Right to be forgotten (user.deleted audit trail)</li></ul><h3 id="audit-system-pci-dss" tabindex="-1">Audit System PCI DSS <a class="header-anchor" href="#audit-system-pci-dss" aria-label="Permalink to &quot;Audit System PCI DSS&quot;">​</a></h3><ul><li>✅ User identification and authentication (auth.*)</li><li>✅ Access control measures (security.access.denied)</li><li>✅ Audit trail for all access to cardholder data</li><li>✅ Security policy enforcement (policy.*)</li></ul><h2 id="audit-logging-implementation-best-practices" tabindex="-1">Audit Logging Implementation Best Practices <a class="header-anchor" href="#audit-logging-implementation-best-practices" aria-label="Permalink to &quot;Audit Logging Implementation Best Practices&quot;">​</a></h2><h3 id="_1-log-retention" tabindex="-1">1. Log Retention <a class="header-anchor" href="#_1-log-retention" aria-label="Permalink to &quot;1. Log Retention&quot;">​</a></h3><p>The AI Security Gateway supports granular retention policies for different data types, allowing you to configure retention periods independently for alerts, audit logs, request logs, token usage, and more.</p><h4 id="configuring-retention-policies" tabindex="-1">Configuring Retention Policies <a class="header-anchor" href="#configuring-retention-policies" aria-label="Permalink to &quot;Configuring Retention Policies&quot;">​</a></h4><p>Configure retention via the <strong>web UI</strong>:</p><ol><li>Navigate to <strong>Settings → Database → Advanced Retention Settings</strong></li><li>Set retention periods for each data type: <ul><li><strong>Security Alerts</strong>: 180 days (recommended)</li><li><strong>Audit Logs</strong>: 90 days (compliance standard)</li><li><strong>Request Logs</strong>: 30 days (privacy-focused)</li><li><strong>Token Usage</strong>: 365 days (annual cost tracking)</li><li><strong>Health Metrics</strong>: 30 days (operational monitoring)</li><li><strong>MCP Tool Logs</strong>: 90 days (same as audit logs)</li><li><strong>LLM Request Logs</strong>: 90 days (same as audit logs)</li><li><strong>A2A Invocation Logs</strong>: 90 days (same as audit logs)</li></ul></li><li>Click <strong>Save</strong> to apply changes</li></ol><h4 id="recommended-retention-periods" tabindex="-1">Recommended Retention Periods <a class="header-anchor" href="#recommended-retention-periods" aria-label="Permalink to &quot;Recommended Retention Periods&quot;">​</a></h4><ul><li><strong>Security Alerts</strong>: 90-180 days (compliance/forensics)</li><li><strong>Audit Logs</strong>: 90 days (compliance requirements)</li><li><strong>Request Logs</strong>: 30 days (privacy - shorter retention)</li><li><strong>Token Usage</strong>: 365 days (annual cost analysis)</li><li><strong>Health Metrics</strong>: 30 days (operational monitoring)</li><li><strong>MCP/LLM/A2A Logs</strong>: 90 days (same as audit logs)</li></ul><h4 id="automatic-cleanup" tabindex="-1">Automatic Cleanup <a class="header-anchor" href="#automatic-cleanup" aria-label="Permalink to &quot;Automatic Cleanup&quot;">​</a></h4><ul><li>Cleanup runs daily at midnight</li><li>Old records are automatically deleted based on retention policy</li><li>Token usage records are now automatically cleaned up (previously missing)</li><li>Changes to retention settings take effect on the next cleanup cycle</li></ul><h3 id="_2-log-analysis" tabindex="-1">2. Log Analysis <a class="header-anchor" href="#_2-log-analysis" aria-label="Permalink to &quot;2. Log Analysis&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Daily security review</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./scripts/audit-report.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y-%m-%d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--critical</span></span></code></pre></div><h3 id="_3-alert-configuration" tabindex="-1">3. Alert Configuration <a class="header-anchor" href="#_3-alert-configuration" aria-label="Permalink to &quot;3. Alert Configuration&quot;">​</a></h3><ul><li>Set up alerts for critical events (security.access.denied)</li><li>Monitor failed login patterns (auth.login.failed)</li><li>Track privilege escalation (user.role.changed)</li></ul><h3 id="_4-regular-audits" tabindex="-1">4. Regular Audits <a class="header-anchor" href="#_4-regular-audits" aria-label="Permalink to &quot;4. Regular Audits&quot;">​</a></h3><ul><li>Weekly: Review critical events</li><li>Monthly: Analyze user activity patterns</li><li>Quarterly: Compliance audit reports</li></ul><h3 id="_5-incident-response" tabindex="-1">5. Incident Response <a class="header-anchor" href="#_5-incident-response" aria-label="Permalink to &quot;5. Incident Response&quot;">​</a></h3><ol><li>Filter logs by time range and user</li><li>Export audit trail to JSON</li><li>Analyze event sequence</li><li>Generate incident report</li></ol><h2 id="audit-logging-performance-considerations" tabindex="-1">Audit Logging Performance Considerations <a class="header-anchor" href="#audit-logging-performance-considerations" aria-label="Permalink to &quot;Audit Logging Performance Considerations&quot;">​</a></h2><ul><li><strong>Minimal Overhead</strong>: Async logging prevents blocking</li><li><strong>Structured Format</strong>: Efficient parsing for analysis</li><li><strong>Log Levels</strong>: Filter by severity in production</li><li><strong>Retention</strong>: Implement log rotation and archival</li></ul><h2 id="audit-logging-implementation-troubleshooting" tabindex="-1">Audit Logging Implementation Troubleshooting <a class="header-anchor" href="#audit-logging-implementation-troubleshooting" aria-label="Permalink to &quot;Audit Logging Implementation Troubleshooting&quot;">​</a></h2><h3 id="missing-audit-logs" tabindex="-1">Missing Audit Logs <a class="header-anchor" href="#missing-audit-logs" aria-label="Permalink to &quot;Missing Audit Logs&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check log file permissions</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -la</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verify audit service is initialized</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Audit service created&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h3 id="high-log-volume" tabindex="-1">High Log Volume <a class="header-anchor" href="#high-log-volume" aria-label="Permalink to &quot;High Log Volume&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check log size</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Filter by severity</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CRITICAL\|WARN&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span></span></code></pre></div><h3 id="parsing-errors" tabindex="-1">Parsing Errors <a class="header-anchor" href="#parsing-errors" aria-label="Permalink to &quot;Parsing Errors&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validate JSON format</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AUDIT_JSON&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs/ai-security-gateway.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span></span></code></pre></div><h2 id="audit-logging-future-enhancements" tabindex="-1">Audit Logging Future Enhancements <a class="header-anchor" href="#audit-logging-future-enhancements" aria-label="Permalink to &quot;Audit Logging Future Enhancements&quot;">​</a></h2><ol><li><strong>Database Audit Trail</strong> - Store audit events in database for querying</li><li><strong>Real-time Dashboards</strong> - Vue.js audit log viewer</li><li><strong>Advanced Alerting</strong> - Machine learning for anomaly detection</li><li><strong>Compliance Reports</strong> - Automated report generation</li><li><strong>External Integrations</strong> - Direct SIEM/SOAR connectors</li></ol><h2 id="related-documentation" tabindex="-1">Related Documentation <a class="header-anchor" href="#related-documentation" aria-label="Permalink to &quot;Related Documentation&quot;">​</a></h2><ul><li><strong>Settings Configuration</strong>: See <a href="./../configuration/system-settings-guide.html">System Settings Guide</a></li><li><strong>SIEM Integration</strong>: See <a href="./../configuration/integration-setup.html">Integration Setup Guide</a></li><li><strong>Compliance</strong>: See <a href="./../compliance/compliance-overview.html">Compliance Overview</a></li><li><strong>External Reference</strong>: <a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html" target="_blank" rel="noreferrer">OWASP Logging Cheat Sheet</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/operations/alert-recording-system.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>Alert Recording</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/operations/user-activity-guide.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>User Activity Tracking Guide</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"a2a_agent-registry-guide.md\":\"B1Pwi2Ze\",\"api-usage_a2a-api.md\":\"Dd5ERpz6\",\"api-usage_api-examples.md\":\"CP8tYqmD\",\"api-usage_authentication-guide.md\":\"BXKKDPBf\",\"api-usage_oauth-api-reference.md\":\"DlMhkZxX\",\"api-usage_proxy-api.md\":\"DhX3LfqE\",\"changelog-2026.2.md\":\"vuffoZkH\",\"configuration_api-key-authentication.md\":\"BcrURTrj\",\"configuration_custom-api-keys.md\":\"3m6XtFYt\",\"configuration_custom-policies-guide.md\":\"D-8zV3HR\",\"configuration_environment-variables.md\":\"Blj5waxW\",\"configuration_oauth-provider-guide.md\":\"BSIijNvs\",\"configuration_oauth-proxy-guide.md\":\"BGuu5A7M\",\"configuration_policy-overview-guide.md\":\"CP6QxyrQ\",\"configuration_system-prompts-guide.md\":\"CBZHgFnn\",\"configuration_xaa-cross-app-access.md\":\"w9AI20sb\",\"deployment_docker-commands.md\":\"CmZLQNW4\",\"deployment_docker-deployment.md\":\"BGG_E2Af\",\"deployment_hybrid-deployment.md\":\"Dl9CTUt8\",\"deployment_web-server-deployment.md\":\"DZZDL9bn\",\"features_data-masking-redaction.md\":\"G53ZHBR2\",\"features_mcp-tool-change.md\":\"DYG0SG3Z\",\"features_mcp-vulnerability-scanner.md\":\"BOwuWpDS\",\"getting-started_admin-quick-start-guide.md\":\"CSvc56bH\",\"getting-started_configuration.md\":\"8_BCeO2Y\",\"getting-started_installation.md\":\"BWAww9XX\",\"index.md\":\"Btcw58aE\",\"integration_claude-code-proxy-setup.md\":\"ZPv8JrSk\",\"integration_cursor-mcp-oauth-setup.md\":\"DaShYOoZ\",\"integration_integration-guide.md\":\"CVhn-92J\",\"integration_langfuse-setup-guide.md\":\"BEh2hsBU\",\"integration_oauth-proxy-chatbot-integration-guide.md\":\"_McSWRyy\",\"integration_oauth-proxy-quick-reference.md\":\"CijiBlBy\",\"operations_alert-recording-system.md\":\"BWuQMVB-\",\"operations_audit-logging.md\":\"DtoZSt6u\",\"operations_budget-management-guide.md\":\"DPGpMHKE\",\"operations_observability-user-guide.md\":\"CZ7vWnf0\",\"operations_security-runbook.md\":\"Ch8DVRq9\",\"operations_troubleshooting.md\":\"x4i9kudQ\",\"operations_user-activity-guide.md\":\"DZn6YMLv\",\"readme.md\":\"C1vqyI79\",\"user-architecture-overview.md\":\"Cf_IzirV\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"AI Security Gateway\",\"description\":\"Security Platform for MCP Servers and LLM APIs - User Guide\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/getting-started/installation\"},{\"text\":\"Configuration\",\"link\":\"/configuration/authentication\"},{\"text\":\"Operations\",\"link\":\"/operations/observability-user-guide\"}],\"sidebar\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Installation\",\"link\":\"/getting-started/installation\"},{\"text\":\"Admin Quick Start\",\"link\":\"/getting-started/admin-quick-start-guide\"},{\"text\":\"Configuration\",\"link\":\"/getting-started/configuration\"},{\"text\":\"Architecture Overview\",\"link\":\"/user-architecture-overview\"}]},{\"text\":\"Changelog\",\"items\":[{\"text\":\"Current 2026.2\",\"link\":\"/changelog-2026.2\"}]},{\"text\":\"Configuration\",\"items\":[{\"text\":\"Authentication\",\"link\":\"/configuration/authentication\"},{\"text\":\"API Key Authentication\",\"link\":\"/configuration/api-key-authentication\"},{\"text\":\"Custom API Keys\",\"link\":\"/configuration/custom-api-keys\"},{\"text\":\"Environment Variables\",\"link\":\"/configuration/environment-variables\"},{\"text\":\"Security Policies\",\"link\":\"/configuration/policy-overview-guide\"},{\"text\":\"Custom Policies\",\"link\":\"/configuration/custom-policies-guide\"},{\"text\":\"System Prompts\",\"link\":\"/configuration/system-prompts-guide\"},{\"text\":\"OAuth Provider Guide\",\"link\":\"/configuration/oauth-provider-guide\"},{\"text\":\"OAuth Proxy Guide\",\"link\":\"/configuration/oauth-proxy-guide\"},{\"text\":\"XAA Cross App Access\",\"link\":\"/configuration/xaa-cross-app-access\"}]},{\"text\":\"Deployment\",\"items\":[{\"text\":\"Docker Commands\",\"link\":\"/deployment/docker-commands\"},{\"text\":\"Docker Deployment\",\"link\":\"/deployment/docker-deployment\"},{\"text\":\"Web Server Deployment\",\"link\":\"/deployment/web-server-deployment\"},{\"text\":\"Hybrid Deployment\",\"link\":\"/deployment/hybrid-deployment\"}]},{\"text\":\"Integration\",\"items\":[{\"text\":\"Integration Overview\",\"link\":\"/integration/integration-guide\"},{\"text\":\"Claude Code Proxy Setup\",\"link\":\"/integration/claude-code-proxy-setup\"},{\"text\":\"Cursor MCP OAuth\",\"link\":\"/integration/cursor-mcp-oauth-setup\"},{\"text\":\"OAuth Chatbot Integration\",\"link\":\"/integration/oauth-proxy-chatbot-integration-guide\"},{\"text\":\"OAuth Quick Reference\",\"link\":\"/integration/oauth-proxy-quick-reference\"},{\"text\":\"Langfuse Setup\",\"link\":\"/integration/langfuse-setup-guide\"}]},{\"text\":\"Operations\",\"items\":[{\"text\":\"Observability Guide\",\"link\":\"/operations/observability-user-guide\"},{\"text\":\"Alert Recording\",\"link\":\"/operations/alert-recording-system\"},{\"text\":\"Audit Logging\",\"link\":\"/operations/audit-logging\"},{\"text\":\"User Activity Tracking Guide\",\"link\":\"/operations/user-activity-guide\"},{\"text\":\"Security Runbook\",\"link\":\"/operations/security-runbook\"},{\"text\":\"Threat Model\",\"link\":\"/operations/threat-model\"},{\"text\":\"Budget Management\",\"link\":\"/operations/budget-management-guide\"},{\"text\":\"Troubleshooting\",\"link\":\"/operations/troubleshooting\"}]},{\"text\":\"Features\",\"items\":[{\"text\":\"Data Masking\",\"link\":\"/features/data-masking-redaction\"},{\"text\":\"MCP Vulnerability Scanner\",\"link\":\"/features/mcp-vulnerability-scanner\"},{\"text\":\"MCP Vool Change Detection\",\"link\":\"/features/mcp-tool-change\"}]},{\"text\":\"API Usage\",\"items\":[{\"text\":\"API Examples\",\"link\":\"/api-usage/api-examples\"},{\"text\":\"Proxy API\",\"link\":\"/api-usage/proxy-api\"},{\"text\":\"OAuth API Reference\",\"link\":\"/api-usage/oauth-api-reference\"},{\"text\":\"A2A API\",\"link\":\"/api-usage/a2a-api\"}]},{\"text\":\"A2A\",\"items\":[{\"text\":\"Agent Registry Guide\",\"link\":\"/a2a/agent-registry-guide\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/syphon1c/ai-security-gateway\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>