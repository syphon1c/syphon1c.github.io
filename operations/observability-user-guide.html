<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Observability &amp; Monitoring User Guide | AI Security Gateway</title>
    <meta name="description" content="Security Platform for MCP Servers and LLM APIs - User Guide">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.qp7qGaqN.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.C59BLWxm.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.504LQ1l3.js">
    <link rel="modulepreload" href="/assets/chunks/theme.TwnW-V7O.js">
    <link rel="modulepreload" href="/assets/chunks/katex.CBSAILhF.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-c83219d4.Cn4f_qOc.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-50d868cf.Drobfpou.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-4f6560a1.CNdJ_7E5.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-0228fc6a.Bu6D8q-s.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-82fe8481.vQZCOTfI.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-a2739b55.DV6DnDRr.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-8eee0895.CjPPGrXo.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-a8764435.DIvmBZWb.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-1e28029f.YiIn7z9c.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-f5964ef8.HgiNdXTf.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-08caed73.BvDzgS2w.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-c5b8d532.BDGY_1aC.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-beda092f.BlqrLRrN.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-2358418a.BrBDGe9j.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-1ecb1508.DTWiSGkk.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-c2b004d7.B-17EPUn.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-c64418c1.Drxj4cYK.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-6af322e1.5iU8Gh8j.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-faaaa080.BqF8Y0Nv.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-8da855dc.20v_iPxn.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-a04cb91d.DGoewZYU.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-c4efeb88.CPOCgxGx.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/operations_observability-user-guide.md.CjLSp2mo.lean.js">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>AI Security Gateway</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/getting-started/installation.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/configuration/authentication.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Configuration</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/operations/observability-user-guide.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Operations</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/syphon1c/ai-security-gateway-beta" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/syphon1c/ai-security-gateway-beta" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Getting Started</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/installation.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/admin-quick-start-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Admin Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/getting-started/configuration.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/user-architecture-overview.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Architecture Overview</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Changelog</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/changelog-2026.2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Current 2026.2</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Configuration</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/authentication.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Authentication</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/api-key-authentication.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API Key Authentication</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/custom-api-keys.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Custom API Keys</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/environment-variables.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Environment Variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/policy-overview-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Security Policies</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/custom-policies-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Custom Policies</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/system-prompts-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>System Prompts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/oauth-provider-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Provider Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/oauth-proxy-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Proxy Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration/xaa-cross-app-access.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>XAA Cross App Access</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Deployment</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/docker-commands.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Docker Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/docker-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Docker Deployment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/web-server-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Web Server Deployment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/deployment/hybrid-deployment.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Hybrid Deployment</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Integration</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/integration-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Integration Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/claude-code-proxy-setup.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Claude Code Proxy Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/cursor-mcp-oauth-setup.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Cursor MCP OAuth</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/oauth-proxy-chatbot-integration-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Chatbot Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/oauth-proxy-quick-reference.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth Quick Reference</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration/langfuse-setup-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Langfuse Setup</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Operations</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/observability-user-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Observability Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/alert-recording-system.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Alert Recording</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/audit-logging.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Audit Logging</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/user-activity-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>User Activity Tracking Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/security-runbook.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Security Runbook</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/threat-model.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Threat Model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/budget-management-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Budget Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/operations/troubleshooting.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Troubleshooting</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>API Usage</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/api-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/proxy-api.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Proxy API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/oauth-api-reference.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>OAuth API Reference</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api-usage/a2a-api.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>A2A API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>A2A</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/a2a/agent-registry-guide.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Agent Registry Guide</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _operations_observability-user-guide" data-v-e6f2a212><div><h1 id="observability-monitoring-user-guide" tabindex="-1">Observability &amp; Monitoring User Guide <a class="header-anchor" href="#observability-monitoring-user-guide" aria-label="Permalink to &quot;Observability &amp; Monitoring User Guide&quot;">​</a></h1><h2 id="observability-overview" tabindex="-1">Observability Overview <a class="header-anchor" href="#observability-overview" aria-label="Permalink to &quot;Observability Overview&quot;">​</a></h2><p>The AI Security Gateway provides comprehensive observability and monitoring capabilities through enhanced metrics and distributed tracing. This guide explains how to configure, access, and leverage these features to monitor system health, performance, and troubleshoot issues.</p><h2 id="observability-table-of-contents" tabindex="-1">Observability Table of Contents <a class="header-anchor" href="#observability-table-of-contents" aria-label="Permalink to &quot;Observability Table of Contents&quot;">​</a></h2><ol><li><a href="#enhanced-metrics">Enhanced Metrics</a></li><li><a href="#distributed-tracing">Distributed Tracing</a></li><li><a href="#integration-with-monitoring-systems">Integration with Monitoring Systems</a></li><li><a href="#best-practices">Best Practices</a></li><li><a href="#troubleshooting">Troubleshooting</a></li></ol><hr><h2 id="enhanced-metrics" tabindex="-1">Enhanced Metrics <a class="header-anchor" href="#enhanced-metrics" aria-label="Permalink to &quot;Enhanced Metrics&quot;">​</a></h2><h3 id="metrics-overview" tabindex="-1">Metrics Overview <a class="header-anchor" href="#metrics-overview" aria-label="Permalink to &quot;Metrics Overview&quot;">​</a></h3><p>Enhanced metrics provide detailed insights into system performance, including request durations, error rates, database query performance, proxy metrics, and policy evaluation statistics. All metrics are available via REST API and Prometheus-compatible endpoints.</p><h3 id="metrics-configuration" tabindex="-1">Metrics Configuration <a class="header-anchor" href="#metrics-configuration" aria-label="Permalink to &quot;Metrics Configuration&quot;">​</a></h3><p>Enhanced metrics are <strong>enabled by default</strong> and require no additional configuration. They automatically track:</p><ul><li><strong>Request Metrics</strong>: Total requests, errors, slow requests, duration percentiles (p50, p95, p99)</li><li><strong>Database Metrics</strong>: Total queries, slow queries, duration percentiles</li><li><strong>Error Metrics</strong>: Breakdown by endpoint and status code</li><li><strong>Proxy Metrics</strong>: Per-proxy request counts, success/error rates, duration</li><li><strong>Policy Metrics</strong>: Total evaluations, matches, misses, hit rate, per-policy details</li><li><strong>System Metrics</strong>: CPU, memory, goroutines</li><li><strong>Connection Pool Metrics</strong>: Utilization, wait counts, connection states</li><li><strong>Cache Metrics</strong>: Hits, misses, hit rate</li></ul><h3 id="accessing-metrics" tabindex="-1">Accessing Metrics <a class="header-anchor" href="#accessing-metrics" aria-label="Permalink to &quot;Accessing Metrics&quot;">​</a></h3><h4 id="_1-rest-api-endpoint" tabindex="-1">1. REST API Endpoint <a class="header-anchor" href="#_1-rest-api-endpoint" aria-label="Permalink to &quot;1. REST API Endpoint&quot;">​</a></h4><p><strong>Endpoint</strong>: <code>GET /api/v1/metrics</code></p><p><strong>Example Request</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/metrics</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer YOUR_JWT_TOKEN&quot;</span></span></code></pre></div><p><strong>Response Structure</strong>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;request_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;total_requests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;total_errors&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;slow_requests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p50&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;45ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p95&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;120ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p99&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;250ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;database_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;total_queries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3450</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;slow_queries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p50&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p95&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;duration_p99&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;15ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;error_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;/api/v1/proxies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;400&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;404&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;500&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;proxy_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;proxy_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;proxy_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MCP Server 1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;proxy_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mcp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;requests_total&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">450</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;requests_success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">435</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;requests_error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;request_duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;125ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;last_request_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-01-15T10:30:00Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;policy_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;total_evaluations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;matches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">125</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;misses&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12375</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;average_duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2ms&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;hit_rate_percent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;policy_details&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;malicious-prompt-detection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          &quot;policy_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;malicious-prompt-detection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          &quot;evaluations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          &quot;matches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          &quot;average_duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.5ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;system_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;cpu_usage_percent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;memory_usage_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;goroutine_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;connection_pool_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;open_connections&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;in_use&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;idle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;wait_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;utilization_percent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cache_metrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;hits&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;misses&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;hit_rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">83.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_2-prometheus-endpoint" tabindex="-1">2. Prometheus Endpoint <a class="header-anchor" href="#_2-prometheus-endpoint" aria-label="Permalink to &quot;2. Prometheus Endpoint&quot;">​</a></h4><p><strong>Endpoint</strong>: <code>GET /api/v1/metrics/prometheus</code></p><p><strong>Example Request</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/metrics/prometheus</span></span></code></pre></div><p><strong>Response Format</strong> (Prometheus text format):</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># HELP gateway_requests_total Total number of HTTP requests</span></span>
<span class="line"><span># TYPE gateway_requests_total counter</span></span>
<span class="line"><span>gateway_requests_total 1250</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HELP gateway_request_duration_seconds Request duration in seconds</span></span>
<span class="line"><span># TYPE gateway_request_duration_seconds histogram</span></span>
<span class="line"><span>gateway_request_duration_seconds_bucket{le=&quot;0.005&quot;} 100</span></span>
<span class="line"><span>gateway_request_duration_seconds_bucket{le=&quot;0.01&quot;} 500</span></span>
<span class="line"><span>gateway_request_duration_seconds_bucket{le=&quot;0.05&quot;} 1000</span></span>
<span class="line"><span>gateway_request_duration_seconds_bucket{le=&quot;0.1&quot;} 1200</span></span>
<span class="line"><span>gateway_request_duration_seconds_bucket{le=&quot;+Inf&quot;} 1250</span></span>
<span class="line"><span>gateway_request_duration_seconds_sum 45.2</span></span>
<span class="line"><span>gateway_request_duration_seconds_count 1250</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HELP gateway_errors_total Total number of errors by endpoint and status</span></span>
<span class="line"><span># TYPE gateway_errors_total counter</span></span>
<span class="line"><span>gateway_errors_total{endpoint=&quot;/api/v1/proxies&quot;,status=&quot;400&quot;} 5</span></span>
<span class="line"><span>gateway_errors_total{endpoint=&quot;/api/v1/proxies&quot;,status=&quot;500&quot;} 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HELP gateway_proxy_requests_total Total proxy requests by proxy</span></span>
<span class="line"><span># TYPE gateway_proxy_requests_total counter</span></span>
<span class="line"><span>gateway_proxy_requests_total{proxy_id=&quot;1&quot;,proxy_name=&quot;MCP Server 1&quot;,proxy_type=&quot;mcp&quot;} 450</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HELP gateway_policy_evaluations_total Total policy evaluations</span></span>
<span class="line"><span># TYPE gateway_policy_evaluations_total counter</span></span>
<span class="line"><span>gateway_policy_evaluations_total 12500</span></span>
<span class="line"><span>gateway_policy_evaluations_matches_total 125</span></span>
<span class="line"><span>gateway_policy_evaluations_misses_total 12375</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HELP gateway_db_queries_total Total database queries</span></span>
<span class="line"><span># TYPE gateway_db_queries_total counter</span></span>
<span class="line"><span>gateway_db_queries_total 3450</span></span></code></pre></div><h4 id="_3-connection-pool-health-endpoint" tabindex="-1">3. Connection Pool Health Endpoint <a class="header-anchor" href="#_3-connection-pool-health-endpoint" aria-label="Permalink to &quot;3. Connection Pool Health Endpoint&quot;">​</a></h4><p><strong>Endpoint</strong>: <code>GET /api/v1/system/db/pool/health</code></p><p><strong>Example Request</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/system/db/pool/health</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer YOUR_JWT_TOKEN&quot;</span></span></code></pre></div><p><strong>Response</strong>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;healthy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;utilization_percent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;open_connections&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;in_use&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;idle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;wait_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Status Values</strong>:</p><ul><li><code>healthy</code> - Normal operation (&lt; 80% utilization, no waits)</li><li><code>degraded</code> - Elevated utilization (80-90%) or occasional waits</li><li><code>critical</code> - High utilization (&gt; 90%) or excessive waits</li></ul><h4 id="_4-connection-pool-stats-endpoint" tabindex="-1">4. Connection Pool Stats Endpoint <a class="header-anchor" href="#_4-connection-pool-stats-endpoint" aria-label="Permalink to &quot;4. Connection Pool Stats Endpoint&quot;">​</a></h4><p><strong>Endpoint</strong>: <code>GET /api/v1/system/db/pool/stats</code></p><p><strong>Example Request</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8080/api/v1/system/db/pool/stats</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer YOUR_JWT_TOKEN&quot;</span></span></code></pre></div><p><strong>Response</strong>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;max_open_connections&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;open_connections&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;in_use&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;idle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;wait_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;wait_duration_ns&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;max_idle_closed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;max_lifetime_closed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;utilization_percent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="metrics-dashboard-integration" tabindex="-1">Metrics Dashboard Integration <a class="header-anchor" href="#metrics-dashboard-integration" aria-label="Permalink to &quot;Metrics Dashboard Integration&quot;">​</a></h3><h4 id="grafana-dashboard-setup" tabindex="-1">Grafana Dashboard Setup <a class="header-anchor" href="#grafana-dashboard-setup" aria-label="Permalink to &quot;Grafana Dashboard Setup&quot;">​</a></h4><ol><li><p><strong>Configure Prometheus Data Source</strong>:</p><ul><li>Add Prometheus as a data source in Grafana</li><li>URL: <code>http://your-gateway:8080/api/v1/metrics/prometheus</code></li></ul></li><li><p><strong>Example Queries</strong>:</p><p><strong>Request Rate</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>rate(gateway_requests_total[5m])</span></span></code></pre></div><p><strong>Error Rate</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>rate(gateway_errors_total[5m])</span></span></code></pre></div><p><strong>Request Duration (p95)</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>histogram_quantile(0.95, rate(gateway_request_duration_seconds_bucket[5m]))</span></span></code></pre></div><p><strong>Proxy Request Rate</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>rate(gateway_proxy_requests_total[5m])</span></span></code></pre></div><p><strong>Policy Hit Rate</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>rate(gateway_policy_evaluations_matches_total[5m]) / rate(gateway_policy_evaluations_total[5m]) * 100</span></span></code></pre></div><p><strong>Database Query Duration (p99)</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>histogram_quantile(0.99, rate(gateway_db_query_duration_seconds_bucket[5m]))</span></span></code></pre></div><p><strong>Connection Pool Utilization</strong>:</p><div class="language-promql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>gateway_db_pool_utilization_percent</span></span></code></pre></div></li><li><p><strong>Recommended Dashboard Panels</strong>:</p><ul><li>Request rate (requests/second)</li><li>Error rate by endpoint</li><li>Request duration percentiles (p50, p95, p99)</li><li>Proxy request rates by proxy</li><li>Policy evaluation metrics</li><li>Database query performance</li><li>Connection pool utilization</li><li>System resource usage (CPU, memory, goroutines)</li></ul></li></ol><h3 id="using-metrics-for-monitoring" tabindex="-1">Using Metrics for Monitoring <a class="header-anchor" href="#using-metrics-for-monitoring" aria-label="Permalink to &quot;Using Metrics for Monitoring&quot;">​</a></h3><h4 id="alerting-rules-prometheus" tabindex="-1">Alerting Rules (Prometheus) <a class="header-anchor" href="#alerting-rules-prometheus" aria-label="Permalink to &quot;Alerting Rules (Prometheus)&quot;">​</a></h4><p>Example alerting rules you can configure in Prometheus:</p><div><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gateway_alerts</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # High error rate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">HighErrorRate</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rate(gateway_errors_total[5m]) &gt; 0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          severity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">warning</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        annotations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;High error rate detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Error rate is {{ $value }} errors/second&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Slow requests</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SlowRequests</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">histogram_quantile(0.95, rate(gateway_request_duration_seconds_bucket[5m])) &gt; 1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          severity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">warning</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        annotations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Slow requests detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;95th percentile request duration is {{ $value }}s&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Connection pool exhaustion</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ConnectionPoolExhaustion</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gateway_db_pool_utilization_percent &gt; 90</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          severity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">critical</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        annotations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Connection pool near exhaustion&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Pool utilization is {{ $value }}%&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # High policy evaluation time</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SlowPolicyEvaluation</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gateway_policy_evaluation_duration_seconds &gt; 0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          severity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">warning</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        annotations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Slow policy evaluation&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Policy evaluation taking {{ $value }}s&quot;</span></span></code></pre></div></div><hr><h2 id="distributed-tracing" tabindex="-1">Distributed Tracing <a class="header-anchor" href="#distributed-tracing" aria-label="Permalink to &quot;Distributed Tracing&quot;">​</a></h2><h3 id="tracing-overview" tabindex="-1">Tracing Overview <a class="header-anchor" href="#tracing-overview" aria-label="Permalink to &quot;Tracing Overview&quot;">​</a></h3><p>Distributed tracing provides end-to-end visibility into request flows across handlers, services, and repositories. This helps debug issues, understand performance bottlenecks, and trace request paths through the system.</p><h3 id="tracing-configuration" tabindex="-1">Tracing Configuration <a class="header-anchor" href="#tracing-configuration" aria-label="Permalink to &quot;Tracing Configuration&quot;">​</a></h3><p>Tracing is <strong>disabled by default</strong> and must be explicitly enabled via environment variables.</p><h4 id="environment-variables" tabindex="-1">Environment Variables <a class="header-anchor" href="#environment-variables" aria-label="Permalink to &quot;Environment Variables&quot;">​</a></h4><table tabindex="0"><thead><tr><th>Variable</th><th>Description</th><th>Default</th><th>Example</th></tr></thead><tbody><tr><td><code>TRACING_ENABLED</code></td><td>Enable/disable tracing</td><td><code>false</code></td><td><code>true</code></td></tr><tr><td><code>TRACING_SERVICE_NAME</code></td><td>Service name for traces</td><td><code>ai-security-gateway</code></td><td><code>ai-security-gateway</code></td></tr><tr><td><code>TRACING_ENVIRONMENT</code></td><td>Environment name</td><td><code>development</code></td><td><code>production</code></td></tr><tr><td><code>TRACING_JAEGER_URL</code></td><td>Jaeger collector endpoint</td><td>-</td><td><code>http://localhost:14268/api/traces</code></td></tr><tr><td><code>TRACING_OTLP_ENDPOINT</code></td><td>OTLP HTTP endpoint</td><td>-</td><td><code>http://localhost:4318</code></td></tr><tr><td><code>TRACING_SAMPLE_RATE</code></td><td>Sampling rate (0.0-1.0)</td><td><code>1.0</code></td><td><code>0.1</code> (10% sampling)</td></tr></tbody></table><h3 id="setup-instructions" tabindex="-1">Setup Instructions <a class="header-anchor" href="#setup-instructions" aria-label="Permalink to &quot;Setup Instructions&quot;">​</a></h3><h4 id="option-1-jaeger-quick-start" tabindex="-1">Option 1: Jaeger (Quick Start) <a class="header-anchor" href="#option-1-jaeger-quick-start" aria-label="Permalink to &quot;Option 1: Jaeger (Quick Start)&quot;">​</a></h4><ol><li><p><strong>Start Jaeger</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jaeger</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16686:16686</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14268:14268</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  jaegertracing/all-in-one:latest</span></span></code></pre></div></li><li><p><strong>Configure Gateway</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_JAEGER_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:14268/api/traces</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SERVICE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ai-security-gateway</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENVIRONMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">development</span></span></code></pre></div></li><li><p><strong>View Traces</strong>:</p><ul><li>Open Jaeger UI: <a href="http://localhost:16686" target="_blank" rel="noreferrer">http://localhost:16686</a></li><li>Select service: <code>ai-security-gateway</code></li><li>Search for traces</li></ul></li></ol><h4 id="option-2-otlp-opentelemetry-protocol" tabindex="-1">Option 2: OTLP (OpenTelemetry Protocol) <a class="header-anchor" href="#option-2-otlp-opentelemetry-protocol" aria-label="Permalink to &quot;Option 2: OTLP (OpenTelemetry Protocol)&quot;">​</a></h4><ol><li><p><strong>Start OTLP Collector</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> otel-collector</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4318:4318</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/otel-collector-config.yaml:/etc/otel-collector-config.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  otel/opentelemetry-collector:latest</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --config=/etc/otel-collector-config.yaml</span></span></code></pre></div></li><li><p><strong>Configure Gateway</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_OTLP_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:4318</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SERVICE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ai-security-gateway</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENVIRONMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">production</span></span></code></pre></div></li><li><p><strong>OTLP Collector Configuration</strong> (<code>otel-collector-config.yaml</code>):</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">receivers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  otlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    protocols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0.0.0.0:4318</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exporters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  jaeger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jaeger:14250</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    loglevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">debug</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  pipelines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    traces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      receivers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">otlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      exporters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jaeger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ol><h3 id="how-tracing-works" tabindex="-1">How Tracing Works <a class="header-anchor" href="#how-tracing-works" aria-label="Permalink to &quot;How Tracing Works&quot;">​</a></h3><h4 id="automatic-tracing" tabindex="-1">Automatic Tracing <a class="header-anchor" href="#automatic-tracing" aria-label="Permalink to &quot;Automatic Tracing&quot;">​</a></h4><p>All HTTP requests are <strong>automatically traced</strong> via middleware. No additional code is required for basic request tracing.</p><p><strong>What&#39;s Captured</strong>:</p><ul><li>Request method, URL, path</li><li>Request headers (user agent, remote address)</li><li>Response status code</li><li>Response size</li><li>Request duration</li><li>Errors (if any)</li></ul><h4 id="trace-context-propagation" tabindex="-1">Trace Context Propagation <a class="header-anchor" href="#trace-context-propagation" aria-label="Permalink to &quot;Trace Context Propagation&quot;">​</a></h4><p>Trace context is automatically propagated through:</p><ul><li>HTTP handlers → Services → Repositories</li><li>All function calls that accept <code>context.Context</code></li><li>Database queries</li><li>Policy evaluations</li><li>Proxy requests</li></ul><h4 id="trace-structure" tabindex="-1">Trace Structure <a class="header-anchor" href="#trace-structure" aria-label="Permalink to &quot;Trace Structure&quot;">​</a></h4><p>A typical trace looks like this:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http.request (root span)</span></span>
<span class="line"><span>├── service.MultiProxyService.ListProxyConfigs</span></span>
<span class="line"><span>│   └── repo.ProxyConfigRepository.List</span></span>
<span class="line"><span>│       └── db.query (SELECT * FROM proxy_configs...)</span></span>
<span class="line"><span>├── service.DashboardService.GetPolicies</span></span>
<span class="line"><span>│   └── repo.PolicyRepository.GetActiveStatusBatch</span></span>
<span class="line"><span>│       └── db.query (SELECT name, active FROM policies...)</span></span>
<span class="line"><span>└── service.PolicyAssignmentService.GetEnabledAssignments</span></span>
<span class="line"><span>    └── repo.PolicyAssignmentRepository.GetByProxyID</span></span>
<span class="line"><span>        └── db.query (SELECT * FROM policy_assignments...)</span></span></code></pre></div><h3 id="viewing-traces" tabindex="-1">Viewing Traces <a class="header-anchor" href="#viewing-traces" aria-label="Permalink to &quot;Viewing Traces&quot;">​</a></h3><h4 id="jaeger-ui" tabindex="-1">Jaeger UI <a class="header-anchor" href="#jaeger-ui" aria-label="Permalink to &quot;Jaeger UI&quot;">​</a></h4><ol><li><p><strong>Access Jaeger UI</strong>: <a href="http://localhost:16686" target="_blank" rel="noreferrer">http://localhost:16686</a></p></li><li><p><strong>Search for Traces</strong>:</p><ul><li>Select service: <code>ai-security-gateway</code></li><li>Choose time range</li><li>Optionally filter by operation, tags, or duration</li></ul></li><li><p><strong>View Trace Details</strong>:</p><ul><li>Click on a trace to see the full span tree</li><li>View span attributes (request details, errors, etc.)</li><li>See timing breakdown for each operation</li></ul></li><li><p><strong>Example Trace View</strong>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Trace: abc123def456</span></span>
<span class="line"><span>Duration: 45ms</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[http.request] 45ms</span></span>
<span class="line"><span>  ├─ [service.MultiProxyService.ListProxyConfigs] 30ms</span></span>
<span class="line"><span>  │   └─ [repo.ProxyConfigRepository.List] 25ms</span></span>
<span class="line"><span>  │       └─ [db.query] 20ms</span></span>
<span class="line"><span>  └─ [service.DashboardService.GetPolicies] 10ms</span></span>
<span class="line"><span>      └─ [repo.PolicyRepository.GetActiveStatusBatch] 8ms</span></span></code></pre></div></li></ol><h4 id="trace-attributes" tabindex="-1">Trace Attributes <a class="header-anchor" href="#trace-attributes" aria-label="Permalink to &quot;Trace Attributes&quot;">​</a></h4><p>Each span includes relevant attributes:</p><p><strong>HTTP Request Spans</strong>:</p><ul><li><code>http.method</code>: HTTP method (GET, POST, etc.)</li><li><code>http.url</code>: Full request URL</li><li><code>http.route</code>: Route path</li><li><code>http.status_code</code>: Response status code</li><li><code>http.response.size</code>: Response size in bytes</li><li><code>http.user_agent</code>: Client user agent</li><li><code>http.remote_addr</code>: Client IP address</li></ul><p><strong>Service Spans</strong>:</p><ul><li><code>service.name</code>: Service name</li><li><code>service.method</code>: Method name</li></ul><p><strong>Repository Spans</strong>:</p><ul><li><code>repository.name</code>: Repository name</li><li><code>repository.method</code>: Method name</li></ul><p><strong>Database Spans</strong>:</p><ul><li><code>db.operation</code>: Operation type (SELECT, INSERT, etc.)</li><li><code>db.statement</code>: SQL query (sanitized)</li><li><code>db.sql.table</code>: Table name</li></ul><p><strong>Policy Spans</strong>:</p><ul><li><code>policy.name</code>: Policy name</li><li><code>policy.matched</code>: Whether policy matched</li></ul><p><strong>Proxy Spans</strong>:</p><ul><li><code>proxy.id</code>: Proxy ID</li><li><code>proxy.name</code>: Proxy name</li><li><code>proxy.type</code>: Proxy type (mcp, llm)</li></ul><h3 id="sampling-configuration" tabindex="-1">Sampling Configuration <a class="header-anchor" href="#sampling-configuration" aria-label="Permalink to &quot;Sampling Configuration&quot;">​</a></h3><p>For high-traffic scenarios, configure sampling to reduce trace volume:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample 10% of requests</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SAMPLE_RATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample 50% of requests</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SAMPLE_RATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample all requests (default)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SAMPLE_RATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span></span></code></pre></div><p><strong>Sampling Strategy</strong>:</p><ul><li>Use <code>1.0</code> (100%) for development and low-traffic production</li><li>Use <code>0.1</code> (10%) for high-traffic production</li><li>Use <code>0.01</code> (1%) for very high-traffic scenarios</li></ul><h3 id="trace-context-in-logs" tabindex="-1">Trace Context in Logs <a class="header-anchor" href="#trace-context-in-logs" aria-label="Permalink to &quot;Trace Context in Logs&quot;">​</a></h3><p>Trace IDs and Span IDs are automatically included in structured logs when available. This allows correlating logs with traces.</p><p><strong>Example Log Entry</strong>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-01-15 10:30:00 INFO [api-server] Failed to list proxy configurations: database connection timeout</span></span>
<span class="line"><span>  trace_id=abc123def456</span></span>
<span class="line"><span>  span_id=789xyz012</span></span></code></pre></div><p><strong>Extracting Trace Context</strong> (for custom logging):</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">github.com/syphon1c/ai-security-gateway-beta/internal/tracing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">traceID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tracing.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TraceIDFromContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spanID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tracing.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SpanIDFromContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Operation completed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, traceID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;span_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, spanID)</span></span></code></pre></div><hr><h2 id="integration-with-monitoring-systems" tabindex="-1">Integration with Monitoring Systems <a class="header-anchor" href="#integration-with-monitoring-systems" aria-label="Permalink to &quot;Integration with Monitoring Systems&quot;">​</a></h2><h3 id="prometheus-grafana" tabindex="-1">Prometheus + Grafana <a class="header-anchor" href="#prometheus-grafana" aria-label="Permalink to &quot;Prometheus + Grafana&quot;">​</a></h3><h4 id="_1-configure-prometheus" tabindex="-1">1. Configure Prometheus <a class="header-anchor" href="#_1-configure-prometheus" aria-label="Permalink to &quot;1. Configure Prometheus&quot;">​</a></h4><p><strong><code>prometheus.yml</code></strong>:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scrape_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">job_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ai-security-gateway&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    scrape_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">15s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    metrics_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/v1/metrics/prometheus&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    static_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost:8080&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h4 id="_2-start-prometheus" tabindex="-1">2. Start Prometheus <a class="header-anchor" href="#_2-start-prometheus" aria-label="Permalink to &quot;2. Start Prometheus&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prometheus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9090:9090</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/prometheus.yml:/etc/prometheus/prometheus.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  prom/prometheus:latest</span></span></code></pre></div><h4 id="_3-create-grafana-dashboard" tabindex="-1">3. Create Grafana Dashboard <a class="header-anchor" href="#_3-create-grafana-dashboard" aria-label="Permalink to &quot;3. Create Grafana Dashboard&quot;">​</a></h4><p>Import the following dashboard JSON or create panels manually:</p><p><strong>Key Panels</strong>:</p><ul><li>Request rate over time</li><li>Error rate by endpoint</li><li>Request duration percentiles</li><li>Proxy metrics by proxy</li><li>Policy evaluation metrics</li><li>Database query performance</li><li>Connection pool health</li><li>System resource usage</li></ul><h3 id="datadog-integration" tabindex="-1">Datadog Integration <a class="header-anchor" href="#datadog-integration" aria-label="Permalink to &quot;Datadog Integration&quot;">​</a></h3><h4 id="_1-configure-datadog-otlp-exporter" tabindex="-1">1. Configure Datadog OTLP Exporter <a class="header-anchor" href="#_1-configure-datadog-otlp-exporter" aria-label="Permalink to &quot;1. Configure Datadog OTLP Exporter&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_OTLP_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https://trace-intake.datadoghq.com</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SERVICE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ai-security-gateway</span></span></code></pre></div><h4 id="_2-configure-datadog-agent" tabindex="-1">2. Configure Datadog Agent <a class="header-anchor" href="#_2-configure-datadog-agent" aria-label="Permalink to &quot;2. Configure Datadog Agent&quot;">​</a></h4><p>The Datadog agent will receive traces via OTLP and forward them to Datadog.</p><h3 id="new-relic-integration" tabindex="-1">New Relic Integration <a class="header-anchor" href="#new-relic-integration" aria-label="Permalink to &quot;New Relic Integration&quot;">​</a></h3><h4 id="_1-configure-new-relic-otlp-exporter" tabindex="-1">1. Configure New Relic OTLP Exporter <a class="header-anchor" href="#_1-configure-new-relic-otlp-exporter" aria-label="Permalink to &quot;1. Configure New Relic OTLP Exporter&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_OTLP_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https://otlp.nr-data.net:4318</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SERVICE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ai-security-gateway</span></span></code></pre></div><h4 id="_2-add-api-key-header" tabindex="-1">2. Add API Key Header <a class="header-anchor" href="#_2-add-api-key-header" aria-label="Permalink to &quot;2. Add API Key Header&quot;">​</a></h4><p>Modify <code>internal/tracing/tracer.go</code> to include New Relic API key in OTLP headers.</p><h3 id="custom-observability-backend" tabindex="-1">Custom Observability Backend <a class="header-anchor" href="#custom-observability-backend" aria-label="Permalink to &quot;Custom Observability Backend&quot;">​</a></h3><p>Any OTLP-compatible backend can be used:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_OTLP_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://your-otel-backend:4318</span></span></code></pre></div><hr><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="metrics" tabindex="-1">Metrics <a class="header-anchor" href="#metrics" aria-label="Permalink to &quot;Metrics&quot;">​</a></h3><ol><li><p><strong>Monitor Key Metrics</strong>:</p><ul><li>Request rate and error rate</li><li>Request duration percentiles (p95, p99)</li><li>Database query performance</li><li>Connection pool utilization</li><li>Policy evaluation performance</li></ul></li><li><p><strong>Set Up Alerts</strong>:</p><ul><li>High error rates (&gt; 1% of requests)</li><li>Slow requests (p95 &gt; 1s)</li><li>Connection pool exhaustion (&gt; 90% utilization)</li><li>High database query times</li></ul></li><li><p><strong>Regular Review</strong>:</p><ul><li>Review metrics dashboard daily</li><li>Investigate error spikes</li><li>Monitor proxy performance trends</li><li>Track policy effectiveness</li></ul></li></ol><h3 id="tracing" tabindex="-1">Tracing <a class="header-anchor" href="#tracing" aria-label="Permalink to &quot;Tracing&quot;">​</a></h3><ol><li><p><strong>Sampling Strategy</strong>:</p><ul><li>Use 100% sampling in development</li><li>Use 10-50% sampling in production</li><li>Adjust based on traffic volume</li></ul></li><li><p><strong>Trace Analysis</strong>:</p><ul><li>Focus on slow traces (&gt; 1s)</li><li>Investigate traces with errors</li><li>Compare trace durations over time</li><li>Identify bottlenecks in span trees</li></ul></li><li><p><strong>Performance Optimization</strong>:</p><ul><li>Use trace data to identify slow operations</li><li>Optimize database queries that appear frequently</li><li>Review service call patterns</li><li>Identify N+1 query patterns</li></ul></li></ol><h3 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h3><ol><li><p><strong>Sensitive Data</strong>:</p><ul><li>Traces may contain request/response data</li><li>Ensure trace data is stored securely</li><li>Consider data retention policies</li><li>Sanitize sensitive information in spans</li></ul></li><li><p><strong>Access Control</strong>:</p><ul><li>Restrict access to metrics endpoints in production</li><li>Use authentication for Prometheus endpoint</li><li>Limit trace export to authorized backends</li></ul></li></ol><hr><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="metrics-not-appearing" tabindex="-1">Metrics Not Appearing <a class="header-anchor" href="#metrics-not-appearing" aria-label="Permalink to &quot;Metrics Not Appearing&quot;">​</a></h3><p><strong>Problem</strong>: Metrics endpoint returns empty or no data.</p><p><strong>Solutions</strong>:</p><ol><li>Verify metrics middleware is registered (should be automatic)</li><li>Check that requests are being made (metrics are request-driven)</li><li>Ensure sufficient time has passed for metrics to accumulate</li><li>Check logs for metrics-related errors</li></ol><h3 id="prometheus-scraping-fails" tabindex="-1">Prometheus Scraping Fails <a class="header-anchor" href="#prometheus-scraping-fails" aria-label="Permalink to &quot;Prometheus Scraping Fails&quot;">​</a></h3><p><strong>Problem</strong>: Prometheus cannot scrape metrics endpoint.</p><p><strong>Solutions</strong>:</p><ol><li>Verify endpoint is accessible: <code>curl http://localhost:8080/api/v1/metrics/prometheus</code></li><li>Check Prometheus configuration (correct URL and path)</li><li>Verify network connectivity between Prometheus and gateway</li><li>Check for authentication requirements</li></ol><h3 id="traces-not-appearing-in-jaeger" tabindex="-1">Traces Not Appearing in Jaeger <a class="header-anchor" href="#traces-not-appearing-in-jaeger" aria-label="Permalink to &quot;Traces Not Appearing in Jaeger&quot;">​</a></h3><p><strong>Problem</strong>: Traces are not showing up in Jaeger UI.</p><p><strong>Solutions</strong>:</p><ol><li>Verify <code>TRACING_ENABLED=true</code> is set</li><li>Check Jaeger URL is correct and accessible</li><li>Verify Jaeger collector is running: <code>docker ps | grep jaeger</code></li><li>Check gateway logs for tracing initialization errors</li><li>Verify sampling rate is not too low</li><li>Wait a few seconds for traces to be exported (batched)</li></ol><h3 id="high-memory-usage-from-tracing" tabindex="-1">High Memory Usage from Tracing <a class="header-anchor" href="#high-memory-usage-from-tracing" aria-label="Permalink to &quot;High Memory Usage from Tracing&quot;">​</a></h3><p><strong>Problem</strong>: Tracing causes high memory usage.</p><p><strong>Solutions</strong>:</p><ol><li>Reduce sampling rate: <code>export TRACING_SAMPLE_RATE=0.1</code></li><li>Ensure exporter is running and consuming traces</li><li>Check for span leaks (spans not being ended)</li><li>Restart gateway if memory usage is excessive</li></ol><h3 id="missing-trace-context" tabindex="-1">Missing Trace Context <a class="header-anchor" href="#missing-trace-context" aria-label="Permalink to &quot;Missing Trace Context&quot;">​</a></h3><p><strong>Problem</strong>: Trace context is not propagated through request chain.</p><p><strong>Solutions</strong>:</p><ol><li>Ensure middleware is registered before other middleware</li><li>Verify <code>context.Context</code> is passed through all function calls</li><li>Check that child spans are created from parent context</li><li>Review code to ensure context propagation is maintained</li></ol><h3 id="connection-pool-alerts" tabindex="-1">Connection Pool Alerts <a class="header-anchor" href="#connection-pool-alerts" aria-label="Permalink to &quot;Connection Pool Alerts&quot;">​</a></h3><p><strong>Problem</strong>: Receiving connection pool exhaustion alerts.</p><p><strong>Solutions</strong>:</p><ol><li>Check connection pool stats endpoint for details</li><li>Review database query patterns for long-running queries</li><li>Increase <code>MaxOpenConns</code> in database configuration if needed</li><li>Optimize slow queries</li><li>Check for connection leaks (connections not being closed)</li></ol><hr><h2 id="example-use-cases" tabindex="-1">Example Use Cases <a class="header-anchor" href="#example-use-cases" aria-label="Permalink to &quot;Example Use Cases&quot;">​</a></h2><h3 id="use-case-1-debugging-slow-api-endpoint" tabindex="-1">Use Case 1: Debugging Slow API Endpoint <a class="header-anchor" href="#use-case-1-debugging-slow-api-endpoint" aria-label="Permalink to &quot;Use Case 1: Debugging Slow API Endpoint&quot;">​</a></h3><p><strong>Scenario</strong>: <code>/api/v1/proxies</code> endpoint is slow.</p><p><strong>Steps</strong>:</p><ol><li>Check metrics: <code>GET /api/v1/metrics</code> → Look at <code>request_metrics.duration_p95</code> for <code>/api/v1/proxies</code></li><li>View trace in Jaeger: Search for traces with operation <code>GET /api/v1/proxies</code></li><li>Analyze span tree: Identify which service/repository call is slow</li><li>Review database queries: Check <code>db.query</code> spans for slow queries</li><li>Optimize: Fix slow queries or add caching</li></ol><h3 id="use-case-2-monitoring-proxy-performance" tabindex="-1">Use Case 2: Monitoring Proxy Performance <a class="header-anchor" href="#use-case-2-monitoring-proxy-performance" aria-label="Permalink to &quot;Use Case 2: Monitoring Proxy Performance&quot;">​</a></h3><p><strong>Scenario</strong>: Monitor performance of specific proxy instances.</p><p><strong>Steps</strong>:</p><ol><li>Query proxy metrics: <code>GET /api/v1/metrics</code> → <code>proxy_metrics[proxy_id]</code></li><li>Set up Grafana dashboard: Create panel for <code>gateway_proxy_requests_total{proxy_id=&quot;1&quot;}</code></li><li>Configure alerts: Alert when error rate &gt; 5% or duration &gt; 500ms</li><li>Review traces: Filter traces by <code>proxy.id</code> attribute</li></ol><h3 id="use-case-3-policy-effectiveness-analysis" tabindex="-1">Use Case 3: Policy Effectiveness Analysis <a class="header-anchor" href="#use-case-3-policy-effectiveness-analysis" aria-label="Permalink to &quot;Use Case 3: Policy Effectiveness Analysis&quot;">​</a></h3><p><strong>Scenario</strong>: Analyze which policies are most effective.</p><p><strong>Steps</strong>:</p><ol><li>Query policy metrics: <code>GET /api/v1/metrics</code> → <code>policy_metrics.policy_details</code></li><li>Calculate hit rates: <code>matches / evaluations * 100</code></li><li>Identify top policies: Sort by match count or hit rate</li><li>Review policy traces: Filter traces by <code>policy.name</code> attribute</li><li>Optimize: Tune policies with low hit rates or high evaluation times</li></ol><h3 id="use-case-4-database-performance-tuning" tabindex="-1">Use Case 4: Database Performance Tuning <a class="header-anchor" href="#use-case-4-database-performance-tuning" aria-label="Permalink to &quot;Use Case 4: Database Performance Tuning&quot;">​</a></h3><p><strong>Scenario</strong>: Optimize database query performance.</p><p><strong>Steps</strong>:</p><ol><li>Check database metrics: <code>GET /api/v1/metrics</code> → <code>database_metrics</code></li><li>Identify slow queries: Review traces with <code>db.query</code> spans &gt; 100ms</li><li>Analyze query patterns: Look for N+1 query patterns in traces</li><li>Optimize: Add indexes, batch queries, or add caching</li><li>Monitor improvements: Track <code>database_metrics.duration_p95</code> over time</li></ol><hr><h2 id="quick-reference" tabindex="-1">Quick Reference <a class="header-anchor" href="#quick-reference" aria-label="Permalink to &quot;Quick Reference&quot;">​</a></h2><h3 id="environment-variables-1" tabindex="-1">Environment Variables <a class="header-anchor" href="#environment-variables-1" aria-label="Permalink to &quot;Environment Variables&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Metrics (always enabled, no config needed)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Tracing</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENABLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SERVICE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ai-security-gateway</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_ENVIRONMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">production</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_JAEGER_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:14268/api/traces</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OR</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_OTLP_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:4318</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TRACING_SAMPLE_RATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span></span></code></pre></div><h3 id="api-endpoints" tabindex="-1">API Endpoints <a class="header-anchor" href="#api-endpoints" aria-label="Permalink to &quot;API Endpoints&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Endpoint</th><th>Method</th><th>Description</th><th>Auth Required</th></tr></thead><tbody><tr><td><code>/api/v1/metrics</code></td><td>GET</td><td>Get all metrics (JSON)</td><td>Yes</td></tr><tr><td><code>/api/v1/metrics/prometheus</code></td><td>GET</td><td>Prometheus metrics</td><td>No</td></tr><tr><td><code>/api/v1/system/db/pool/health</code></td><td>GET</td><td>Connection pool health</td><td>Yes</td></tr><tr><td><code>/api/v1/system/db/pool/stats</code></td><td>GET</td><td>Connection pool stats</td><td>Yes</td></tr></tbody></table><h3 id="docker-compose-example" tabindex="-1">Docker Compose Example <a class="header-anchor" href="#docker-compose-example" aria-label="Permalink to &quot;Docker Compose Example&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.8&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  gateway</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ai-security-gateway:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8080:8080&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TRACING_ENABLED=true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TRACING_JAEGER_URL=http://jaeger:14268/api/traces</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TRACING_SERVICE_NAME=ai-security-gateway</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TRACING_ENVIRONMENT=production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TRACING_SAMPLE_RATE=0.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  jaeger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jaegertracing/all-in-one:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;16686:16686&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # UI</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;14268:14268&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Collector</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">prom/prometheus:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;9090:9090&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./prometheus.yml:/etc/prometheus/prometheus.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  grafana</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">grafana/grafana:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3000:3000&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">GF_SECURITY_ADMIN_PASSWORD=admin</span></span></code></pre></div><hr><h2 id="support" tabindex="-1">Support <a class="header-anchor" href="#support" aria-label="Permalink to &quot;Support&quot;">​</a></h2><p>For additional help:</p><ul><li>Review <code>docs/tracing-guide.md</code> for detailed tracing documentation</li><li>Check gateway logs for errors</li><li>Review metrics endpoint responses for system status</li><li>Consult OpenTelemetry documentation for advanced tracing configuration</li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/integration/langfuse-setup-guide.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>Langfuse Setup</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/operations/alert-recording-system.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Alert Recording</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"a2a_agent-registry-guide.md\":\"B1Pwi2Ze\",\"api-usage_a2a-api.md\":\"Dd5ERpz6\",\"api-usage_api-examples.md\":\"CP8tYqmD\",\"api-usage_authentication-guide.md\":\"BXKKDPBf\",\"api-usage_oauth-api-reference.md\":\"DlMhkZxX\",\"api-usage_proxy-api.md\":\"YTkvxr4v\",\"changelog-2026.2.md\":\"BI1DSkBD\",\"configuration_api-key-authentication.md\":\"BcrURTrj\",\"configuration_custom-api-keys.md\":\"3m6XtFYt\",\"configuration_custom-policies-guide.md\":\"D-8zV3HR\",\"configuration_environment-variables.md\":\"Blj5waxW\",\"configuration_oauth-provider-guide.md\":\"BSIijNvs\",\"configuration_oauth-proxy-guide.md\":\"BGuu5A7M\",\"configuration_policy-overview-guide.md\":\"CP6QxyrQ\",\"configuration_system-prompts-guide.md\":\"CBZHgFnn\",\"configuration_xaa-cross-app-access.md\":\"Dk7hK2Nn\",\"deployment_docker-commands.md\":\"BzBMdUnr\",\"deployment_docker-deployment.md\":\"Dw9cOGlF\",\"deployment_hybrid-deployment.md\":\"D3Uq2bj7\",\"deployment_web-server-deployment.md\":\"Drq9Kj5H\",\"getting-started_admin-quick-start-guide.md\":\"tNUg4dns\",\"getting-started_configuration.md\":\"8_BCeO2Y\",\"getting-started_installation.md\":\"C75bviOC\",\"index.md\":\"QdHQd1IJ\",\"integration_claude-code-proxy-setup.md\":\"ZPv8JrSk\",\"integration_cursor-mcp-oauth-setup.md\":\"DaShYOoZ\",\"integration_integration-guide.md\":\"CVhn-92J\",\"integration_langfuse-setup-guide.md\":\"BEh2hsBU\",\"integration_oauth-proxy-chatbot-integration-guide.md\":\"_McSWRyy\",\"integration_oauth-proxy-quick-reference.md\":\"CijiBlBy\",\"operations_alert-recording-system.md\":\"BWuQMVB-\",\"operations_audit-logging.md\":\"DtoZSt6u\",\"operations_budget-management-guide.md\":\"DPGpMHKE\",\"operations_observability-user-guide.md\":\"CjLSp2mo\",\"operations_security-runbook.md\":\"Ch8DVRq9\",\"operations_troubleshooting.md\":\"DlidgcaQ\",\"operations_user-activity-guide.md\":\"DZn6YMLv\",\"readme.md\":\"C1vqyI79\",\"user-architecture-overview.md\":\"Cf_IzirV\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"AI Security Gateway\",\"description\":\"Security Platform for MCP Servers and LLM APIs - User Guide\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/getting-started/installation\"},{\"text\":\"Configuration\",\"link\":\"/configuration/authentication\"},{\"text\":\"Operations\",\"link\":\"/operations/observability-user-guide\"}],\"sidebar\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Installation\",\"link\":\"/getting-started/installation\"},{\"text\":\"Admin Quick Start\",\"link\":\"/getting-started/admin-quick-start-guide\"},{\"text\":\"Configuration\",\"link\":\"/getting-started/configuration\"},{\"text\":\"Architecture Overview\",\"link\":\"/user-architecture-overview\"}]},{\"text\":\"Changelog\",\"items\":[{\"text\":\"Current 2026.2\",\"link\":\"/changelog-2026.2\"}]},{\"text\":\"Configuration\",\"items\":[{\"text\":\"Authentication\",\"link\":\"/configuration/authentication\"},{\"text\":\"API Key Authentication\",\"link\":\"/configuration/api-key-authentication\"},{\"text\":\"Custom API Keys\",\"link\":\"/configuration/custom-api-keys\"},{\"text\":\"Environment Variables\",\"link\":\"/configuration/environment-variables\"},{\"text\":\"Security Policies\",\"link\":\"/configuration/policy-overview-guide\"},{\"text\":\"Custom Policies\",\"link\":\"/configuration/custom-policies-guide\"},{\"text\":\"System Prompts\",\"link\":\"/configuration/system-prompts-guide\"},{\"text\":\"OAuth Provider Guide\",\"link\":\"/configuration/oauth-provider-guide\"},{\"text\":\"OAuth Proxy Guide\",\"link\":\"/configuration/oauth-proxy-guide\"},{\"text\":\"XAA Cross App Access\",\"link\":\"/configuration/xaa-cross-app-access\"}]},{\"text\":\"Deployment\",\"items\":[{\"text\":\"Docker Commands\",\"link\":\"/deployment/docker-commands\"},{\"text\":\"Docker Deployment\",\"link\":\"/deployment/docker-deployment\"},{\"text\":\"Web Server Deployment\",\"link\":\"/deployment/web-server-deployment\"},{\"text\":\"Hybrid Deployment\",\"link\":\"/deployment/hybrid-deployment\"}]},{\"text\":\"Integration\",\"items\":[{\"text\":\"Integration Overview\",\"link\":\"/integration/integration-guide\"},{\"text\":\"Claude Code Proxy Setup\",\"link\":\"/integration/claude-code-proxy-setup\"},{\"text\":\"Cursor MCP OAuth\",\"link\":\"/integration/cursor-mcp-oauth-setup\"},{\"text\":\"OAuth Chatbot Integration\",\"link\":\"/integration/oauth-proxy-chatbot-integration-guide\"},{\"text\":\"OAuth Quick Reference\",\"link\":\"/integration/oauth-proxy-quick-reference\"},{\"text\":\"Langfuse Setup\",\"link\":\"/integration/langfuse-setup-guide\"}]},{\"text\":\"Operations\",\"items\":[{\"text\":\"Observability Guide\",\"link\":\"/operations/observability-user-guide\"},{\"text\":\"Alert Recording\",\"link\":\"/operations/alert-recording-system\"},{\"text\":\"Audit Logging\",\"link\":\"/operations/audit-logging\"},{\"text\":\"User Activity Tracking Guide\",\"link\":\"/operations/user-activity-guide\"},{\"text\":\"Security Runbook\",\"link\":\"/operations/security-runbook\"},{\"text\":\"Threat Model\",\"link\":\"/operations/threat-model\"},{\"text\":\"Budget Management\",\"link\":\"/operations/budget-management-guide\"},{\"text\":\"Troubleshooting\",\"link\":\"/operations/troubleshooting\"}]},{\"text\":\"API Usage\",\"items\":[{\"text\":\"API Examples\",\"link\":\"/api-usage/api-examples\"},{\"text\":\"Proxy API\",\"link\":\"/api-usage/proxy-api\"},{\"text\":\"OAuth API Reference\",\"link\":\"/api-usage/oauth-api-reference\"},{\"text\":\"A2A API\",\"link\":\"/api-usage/a2a-api\"}]},{\"text\":\"A2A\",\"items\":[{\"text\":\"Agent Registry Guide\",\"link\":\"/a2a/agent-registry-guide\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/syphon1c/ai-security-gateway-beta\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>